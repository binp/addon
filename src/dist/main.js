/*! For license information please see main.js.LICENSE.txt */
var helloWorld;(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const t="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var e=Object.defineProperty,t=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(n,r){if(r)e:{var i=t;n=n.split(".");for(var s=0;s<n.length-1;s++){var o=n[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[n=n[n.length-1]]))!=s&&null!=r&&e(i,n,{configurable:!0,writable:!0,value:r})}}("Symbol.dispose",(function(e){return e||Symbol("Symbol.dispose")}));var n,r,i=this||self;function s(e,t){function n(){}n.prototype=t.prototype,e.qa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.oa=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function o(e,t){if(Error.captureStackTrace)Error.captureStackTrace(this,o);else{const e=Error().stack;e&&(this.stack=e)}e&&(this.message=String(e)),void 0!==t&&(this.cause=t)}function a(e){i.setTimeout((()=>{throw e}),0)}s(o,Error),o.prototype.name="CustomError";e:{for(var c=["CLOSURE_FLAGS"],l=i,u=0;u<c.length;u++)if(null==(l=l[c[u]])){r=null;break e}r=l}var d,h=r&&r[610401301];n=null!=h&&h;const f=i.navigator;function p(e){return!!n&&!!d&&d.brands.some((({brand:t})=>t&&-1!=t.indexOf(e)))}function g(e){var t;return(t=i.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}function m(){return!!n&&!!d&&d.brands.length>0}function v(){return m()?p("Chromium"):(g("Chrome")||g("CriOS"))&&!(!m()&&g("Edge"))||g("Silk")}function y(e,t){(t=Array.prototype.indexOf.call(e,t,void 0))>=0&&Array.prototype.splice.call(e,t,1)}function w(e){let t="",n=0;const r=e.length-10240;for(;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}d=f&&f.userAgentData||null,!g("Android")||v(),v(),g("Safari")&&(v()||!m()&&g("Coast")||!m()&&g("Opera")||!m()&&g("Edge")||(m()?p("Microsoft Edge"):g("Edg/"))||m()&&p("Opera"));const I=/[-_.]/g,b={"-":"+",_:"/",".":"="};function _(e){return b[e]||""}function E(e){return null!=e&&e instanceof Uint8Array}var S={};function T(){return k||(k=new C(null,S))}var C=class{constructor(e,t){if(P(t),this.g=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}};let k,A;function P(e){if(e!==S)throw Error("illegal external caller")}function N(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function O(){const e=Error();N(e,"incident"),a(e)}function R(e){return N(e=Error(e),"warning"),e}function D(){return"function"==typeof BigInt}function L(e){return Array.prototype.slice.call(e)}function x(e,t){return t&&Symbol.for&&e?Symbol.for(e):null!=e?Symbol(e):Symbol()}var M=x("jas",!0);x();var U=x(),j=x();function F(e,t){t[M]=-30975&e}function $(e,t){t[M]=-30941&e|34}x(),x();var B,V={},H={};function z(e){return!(!e||"object"!=typeof e||e.g!==H)}function W(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function G(e,t){if(null!=e)if("string"==typeof e)e=e?new C(e,S):T();else if(e.constructor!==C)if(E(e))e=e.length?new C(new Uint8Array(e),S):T();else{if(!t)throw Error();e=void 0}return e}function K(e){return!(!Array.isArray(e)||e.length||!(1&e[M]))}const q=[];function J(e){if(2&e)throw Error()}q[M]=55,B=Object.freeze(q);var Y=Object.freeze({});function X(e){return e.pa=!0,e}var Q=X((e=>"number"==typeof e)),Z=X((e=>"string"==typeof e)),ee=X((e=>"boolean"==typeof e)),te="function"==typeof i.BigInt&&"bigint"==typeof i.BigInt(0),ne=X((e=>te?e>=ie&&e<=oe:"-"===e[0]?ae(e,re):ae(e,se)));const re=Number.MIN_SAFE_INTEGER.toString(),ie=te?BigInt(Number.MIN_SAFE_INTEGER):void 0,se=Number.MAX_SAFE_INTEGER.toString(),oe=te?BigInt(Number.MAX_SAFE_INTEGER):void 0;function ae(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];if(r>i)return!1;if(r<i)return!0}}let ce=0,le=0;function ue(e){const t=e>>>0;ce=t,le=(e-t)/4294967296>>>0}function de(e){if(e<0){ue(-e);const[t,n]=pe(ce,le);ce=t>>>0,le=n>>>0}else ue(e)}function he(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else D()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+fe(n)+fe(e));return n}function fe(e){return e=String(e),"0000000".slice(e.length)+e}function pe(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function ge(e){return null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0}const me=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function ve(e){const t=typeof e;switch(t){case"bigint":return!0;case"number":return Number.isFinite(e)}return"string"===t&&me.test(e)}function ye(e){if(null!=e){if(!Number.isFinite(e))throw R("enum");e|=0}return e}function we(e){if(null!=e){if("string"==typeof e){if(!e)return;e=+e}"number"==typeof e&&Number.isFinite(e)}}function Ie(e){if(null!=e)e:{if(!ve(e))throw R("int64");switch(typeof e){case"string":e=_e(e);break e;case"bigint":var t=e=BigInt.asIntN(64,e);if(Z(t)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(t))throw Error(String(t))}else if(Q(t)&&!Number.isSafeInteger(t))throw Error(String(t));e=te?BigInt(e):ee(e)?e?"1":"0":Z(e)?e.trim()||"0":String(e);break e;default:e=be(e)}}return e}function be(e){if(e=Math.trunc(e),!Number.isSafeInteger(e)){de(e);var t=ce,n=le;(e=2147483648&n)&&(n=~n>>>0,0==(t=1+~t>>>0)&&(n=n+1>>>0));const r=4294967296*n+(t>>>0);e="number"==typeof(t=Number.isSafeInteger(r)?r:he(t,n))?e?-t:t:e?"-"+t:t}return e}function _e(e){var t=Math.trunc(Number(e));if(Number.isSafeInteger(t))return String(t);if(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),!("-"===e[0]?e.length<20||20===e.length&&Number(e.substring(0,7))>-922337:e.length<19||19===e.length&&Number(e.substring(0,6))<922337)){if(e.length<16)de(Number(e));else if(D())e=BigInt(e),ce=Number(e&BigInt(4294967295))>>>0,le=Number(e>>BigInt(32)&BigInt(4294967295));else{t=+("-"===e[0]),le=ce=0;const n=e.length;for(let r=t,i=(n-t)%6+t;i<=n;r=i,i+=6){const t=Number(e.slice(r,i));le*=1e6,ce=1e6*ce+t,ce>=4294967296&&(le+=Math.trunc(ce/4294967296),le>>>=0,ce>>>=0)}if(t){const[e,t]=pe(ce,le);ce=e,le=t}}if(e=ce,2147483648&(t=le))if(D())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=pe(e,t);e="-"+he(n,r)}else e=he(e,t)}return e}function Ee(e){if(null!=e&&"string"!=typeof e)throw Error();return e}function Se(e,t,n){if(null!=e&&"object"==typeof e&&e.H===V)return e;if(Array.isArray(e)){var r=0|e[M],i=r;return 0===i&&(i|=32&n),(i|=2&n)!==r&&(e[M]=i),new t(e)}}let Te,Ce,ke,Ae,Pe,Ne;function Oe(e){let t;return null==(t=Te)?void 0:t.get(e)}function Re(e){try{return-1!==e.toString().indexOf("[native code]")?e:null}catch{return null}}function De(e,t){return Le(t)}function Le(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"bigint":return ne(e)?Number(e):String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(K(e))return}else{if(E(e))return w(e);if(e instanceof C){const t=e.g;return null==t?"":"string"==typeof t?t:e.g=w(t)}}}return e}function xe(e,t,n,r,i){if(null!=e){if(Array.isArray(e))e=K(e)?void 0:i&&2&e[M]?e:Me(e,t,n,void 0!==r,i);else if(W(e)){const s={};for(let o in e)s[o]=xe(e[o],t,n,r,i);e=s}else e=t(e,r);return e}}function Me(e,t,n,r,i){const s=r||n?0|e[M]:0;r=r?!!(32&s):void 0,e=L(e);for(let s=0;s<e.length;s++)e[s]=xe(e[s],t,n,r,i);return n&&n(s,e),e}function Ue(e){return e.H===V?e.toJSON():Le(e)}function je(e,t,n=$){if(null!=e){if(e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[M];return 2&r?e:(t&&(t=0===r||!!(32&r)&&!(64&r||!(16&r))),t?(e[M]=-12293&r|34,e):Me(e,je,4&r?$:n,!0,!0))}return e.H===V&&(e=2&(r=(n=e.m)[M])?e:new e.constructor(Fe(n,r,!0))),e}}function Fe(e,t,n){const r=n||2&t?$:F,i=!!(32&t);return e=function(e,t,n){var r=(e=L(e)).length;const i=256&t?e[r-1]:void 0;for(r+=i?-1:0,t=512&t?1:0;t<r;t++)e[t]=n(e[t]);if(i){t=e[t]={};for(const e in i)t[e]=n(i[e])}return e}(e,t,(e=>je(e,i,r))),e[M]=32|e[M]|(n?2:0),e}function $e(e){const t=e.m,n=t[M];return 2&n?new e.constructor(Fe(t,n,!1)):e}function Be(e,t){return He(e=e.m,e[M],t)}function Ve(e,t,n,r){if(!((t=r+(+!!(512&t)-1))<0||t>=e.length||t>=n))return e[t]}function He(e,t,n,r){if(-1===n)return null;const i=t>>15&1023||536870912;if(!(n>=i)){var s,o=e.length;return r&&256&t&&null!=(r=e[o-1][n])?(Ve(e,t,i,n)&&null!=U&&(e=null!=(s=A)?s:A={},(s=e[U]||0)>=4||(e[U]=s+1,O())),r):Ve(e,t,i,n)}return 256&t?e[e.length-1][n]:void 0}function ze(e,t,n){const r=e.m;let i=r[M];return J(i),We(r,i,t,n),e}function We(e,t,n,r){const i=t>>15&1023||536870912;if(n>=i){let s,o=t;if(256&t)s=e[e.length-1];else{if(null==r)return o;s=e[i+(+!!(512&t)-1)]={},o|=256}return s[n]=r,n<i&&(e[n+(+!!(512&t)-1)]=void 0),o!==t&&(e[M]=o),o}return e[n+(+!!(512&t)-1)]=r,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function Ge(e,t,n,r){return void 0!==Qe(e,t,n=Je(e,r)===n?n:-1)}function Ke(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function qe(e,t,n,r){const i=e.m;let s=i[M];return J(s),We(i,s,t,("0"===r?0===Number(n):n===r)?void 0:n),e}function Je(e,t){return Xe(Ye(e=e.m),e,e[M],t)}function Ye(e){let t;return null!=(t=e[j])?t:e[j]=new Map}function Xe(e,t,n,r){let i=e.get(r);if(null!=i)return i;i=0;for(let e=0;e<r.length;e++){const s=r[e];null!=He(t,n,s)&&(0!==i&&(n=We(t,n,i)),i=s)}return e.set(r,i),i}function Qe(e,t,n,r){let i=(e=e.m)[M];return(t=Se(r=He(e,i,n,r),t,i))!==r&&null!=t&&We(e,i,n,t),t}function Ze(e,t,n){if(null==(t=Qe(e,t,n,!1)))return t;let r=(e=e.m)[M];if(!(2&r)){const i=$e(t);i!==t&&We(e,r,n,t=i)}return t}function et(e,t,n){return null==n&&(n=void 0),ze(e,t,n)}function tt(e,t,n,r){null==r&&(r=void 0);e:{const o=e.m;var i=o[M];if(J(i),null==r){var s=Ye(o);if(Xe(s,o,i,n)!==t)break e;s.set(n,0)}else{const e=Ye(s=o),r=Xe(e,s,i,n);r!==t&&(r&&(i=We(s,i,r)),e.set(n,t))}We(o,i,t,r)}return e}function nt(e,t){const n=e.m;let r=n[M];if(J(r),null==t)return We(n,r,1),e;var i,s=t;t=(null==(i=Ce)?void 0:i.get(s))||s,i=s=0|t[M];const o=Ke(s),a=o||Object.isFrozen(t);let c=!0,l=!0;for(let e=0;e<t.length;e++){var u=t[e];o||(u=!!(2&u.m[M]),c&&(c=!u),l&&(l=u))}return o||(s=c?13:5,s=l?16|s:-17&s),a&&s===i||(t=L(t),i=0,s=it(s=rt(s,r),r,!0)),s!==i&&(t[M]=s),We(n,r,1,t),e}function rt(e,t){return-2049&(2&t?2|e:-3&e)|32}function it(e,t,n){return 32&t&&n||(e&=-33),e}function st(e,t){return null!=e?e:t}function ot(e){return null!=(e=Be(e,1))&&("bigint"==typeof e?ne(e)?e=Number(e):(e=BigInt.asIntN(64,e),e=ne(e)?Number(e):String(e)):e=ve(e)?"number"==typeof e?be(e):_e(e):void 0),st(e,0)}function at(e,t){return st(null==(e=Be(e,t))||"string"==typeof e?e:void 0,"")}function ct(e,t){return st(e=null==(e=Be(e,t))?e:Number.isFinite(e)?0|e:void 0,0)}function lt(e,t,n,r){return Ze(e,t,n=Je(e,r)===n?n:-1)}function ut(e){try{return Ne=!0,JSON.stringify(ht(e),De)}finally{Ne=!1}}var dt=class{constructor(e){e:{var t=null!=t?t:0;if(null==e){var n=96;e=[]}else{if(!Array.isArray(e))throw Error("narr");if(2048&(n=0|e[M]))throw Error("farr");if(64&n)break e;1===t||2===t||(n|=64);var r=(t=e).length;if(r&&W(t[--r])){if((t=r-(+!!(512&(n|=256))-1))>=1024)throw Error("pvtlmt");n=-33521665&n|(1023&t)<<15}}e[M]=n}this.m=e}toJSON(){return ht(this)}};function ht(e){e=e.m,e=Ne?e:Me(e,Ue,void 0,void 0,!1);{var t=!Ne;let l=e.length;if(l){var n=e[l-1],r=W(n);r?l--:n=void 0;var i=e;if(r){e:{var s,o=n,a=!1;if(o)for(let e in o)if(isNaN(+e)){let t;(null!=(t=s)?t:s={})[e]=o[e]}else if(r=o[e],Array.isArray(r)&&(K(r)||z(r)&&0===r.size)&&(r=null),null==r&&(a=!0),null!=r){let t;(null!=(t=s)?t:s={})[e]=r}if(a||(s=o),s)for(let e in s){a=s;break e}a=null}o=null==a?null!=n:a!==n}for(;l>0&&(null==(s=i[l-1])||K(s)||z(s)&&0===s.size);l--)var c=!0;(i!==e||o||c)&&(t?(c||o||a)&&(i.length=l):i=Array.prototype.slice.call(i,0,l),a&&i.push(a)),c=i}else c=e}return c}function ft(e){return t=>{if(null==t||""==t)t=new e;else{if(t=JSON.parse(t),!Array.isArray(t))throw Error("dnarr");t[M]|=32,t=new e(t)}return t}}dt.prototype.H=V,dt.prototype.toString=function(){try{return Ne=!0,ht(this).toString()}finally{Ne=!1}};var pt,gt=(pt=class extends dt{},e=>{if(e=JSON.parse(e),!Array.isArray(e)){var t=typeof e;throw Error("Expected jspb data to be an array, got "+("object"!=t?t:e?Array.isArray(e)?"array":t:"null")+": "+e)}return e[M]|=34,new pt(e)}),mt=class extends dt{};function vt(e){return yt(e,e.index)>=e.g&&(e.h[e.index]=Date.now(),e.index=(e.index+1)%1,!0)}function yt(e,t){let n;return Date.now()-(null!=(n=e.h[t])?n:-1*e.g)}var wt=class{constructor(e){this.g=e,this.h=[],this.index=0}},It=class extends dt{},bt=[2,3],_t=class extends dt{},Et=class extends Error{constructor({errorType:e,message:t,i:n}){super(`Meet Add-on SDK error: ${t}${n?` - ${n}`:""}`),this.errorType=e}},St={errorType:"InternalError",message:"An unexpected error has occurred.",i:"No further information is available."},Tt={errorType:"MissingUrlParameter",message:"Missing required Meet SDK URL parameter",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not strip URL parameters (e.g. as part of a redirect)."},Ct={errorType:"NeedsMainStageContext",message:"This method can only be invoked if the addon is running in the main stage.",i:"Use getFrameType to check whether the addon is running in the main stage before invoking this method."},kt={errorType:"NeedsSidePanelContext",message:"This method can only be invoked if the addon is running in the side panel.",i:"Use getFrameType to check whether the addon is running in the side panel before invoking this method."},At={errorType:"NotSupportedInStandalone",message:"This method is not supported in standalone mode.",i:"Do not call this method in standalone mode."},Pt={errorType:"InternalError",message:"The frame type URL parameter is set to an unexpected value.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect)."},Nt={errorType:"InvalidCloudProjectNumber",message:"Cloud Project Number provided by meet does not match the one passed in by the SDK. Ensure that the correct Cloud Project Number is passed to the SDK as a string.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect) and ensure that the correct Cloud Project Number was passed into the SDK as a string."},Ot={errorType:"DestinationNotReady",message:"The recipient frame is not connected via the addon SDK and cannot receive the notification.",i:"Make sure the destination frame has connected before sending messages to it."},Rt={errorType:"InvalidActivityStartingState",message:"Origin of the ActivityStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the ActivityStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Dt={errorType:"ActivityStartingStateMissingAttributes",message:"The supplied ActivityStartingState object does not contain any recognized attributes.",i:"Ensure that the ActivityStartingState object contains at least one of the following attributes: mainStageUrl, sidePanelUrl, additionalData."},Lt={errorType:"ActivityStartingStateUnrecognizedAttributes",message:"The supplied ActivityStartingState object contains attributes that are not recognized.",i:"Ensure that the ActivityStartingState object has only the following attributes: mainStageUrl, sidePanelUrl, additionalData."},xt={errorType:"AddonStartingStateMissingAttributes",message:"The supplied AddonStartingState object does not contain any recognized attributes.",i:"Ensure that the AddonStartingState object contains at least one of the following attributes: sidePanelUrl, additionalData."},Mt={errorType:"AddonStartingStateUnrecognizedAttributes",message:"The supplied AddonStartingState object contains attributes that are not recognized.",i:"Ensure that the AddonStartingState object has only the following attributes: sidePanelUrl, additionalData."},Ut=e=>({errorType:"ArgumentNullError",message:`The argument supplied for '${e}' was 'null' but a value was expected.`,i:"Ensure you are passing a value of the expected type for the argument."}),jt=(e,t,n)=>({errorType:"ArgumentTypeError",message:`The type '${t}' of argument supplied for '${e}' did not match the expected type '${n}'.`,i:"Ensure the type of the argument provided matches the expected type."}),Ft={errorType:"ActivityIsOngoing",message:"Operation cannot be performed while an activity is ongoing.",i:"Ensure that no activity is ongoing."},$t={errorType:"InternalError",message:"Frame message missing required Meet SDK command.",i:"Send one of the available commands in the frame message."},Bt={errorType:"NoActivityFound",message:"No activity found.",i:"Ensure that the activity is started before performing this operation."},Vt={errorType:"RequiresEapEnrollment",message:"This feature is only available to early access partners.",i:"Meet add-on early access enrollment is currently closed."},Ht={errorType:"UserNotInitiator",message:"Operation cannot be performed because the user is not the initiator of the current activity.",i:"Ensure that the user is the initiator of the current activity or that the activity has ended."},zt={errorType:"SizeLimitExceededActivityStartingState",message:"The size of the activityStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the activityStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Wt={errorType:"SizeLimitExceededFrameToFrameMessage",message:"The size of the frame to frame message exceeds the limits allowed.",i:"Ensure that the frame to frame message size is less than 1,000,000 characters."},Gt={errorType:"AddonSessionAlreadyCreated",message:"The addon session has already been created.",i:"Only instantiate the AddonSession once."},Kt={errorType:"UserCancelled",message:"The user cancelled starting an activity.",i:"The user needs to click continue to start the activity."},qt={errorType:"NotSupportedInMeetCall",message:"This method is not supported during a Meet call.",i:"Do not call this method during a Meet call."},Jt={errorType:"InvalidAddonStartingState",message:"Origin of the AddonStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the AddonStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Yt={errorType:"SizeLimitExceededAddonStartingState",message:"The size of the AddonStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the AddonStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Xt={errorType:"MeetingPolicyPreventsStartingActivity",message:"A meeting policy (such as using host control settings) prevents the user from starting the activity.",i:"Have a meeting host or administrator modify the necessary settings to allow the current user to start the activity."};function Qt({errorType:e,message:t,i:n},r=""){throw new Et({errorType:e,message:r?`${t} ${r}`:t,i:n})}function Zt(e,t){Qt({...Tt,message:`${Tt.message}: ${e}. In URL ${t}`})}function en(e){return qe(new rn,1,ye(e),0)}function tn(e,t){return qe(e,2,Ee(t),"")}function nn(e,t){return qe(e,3,Ee(t),"")}var rn=class extends dt{getFrameType(){return ct(this,1)}};function sn(e){var t;t=void 0===Y?2:4;var n=e.m[M],r=n,i=!(2&n),s=rn;t=(n=!!(2&r))?1:t,i&&(i=!n),n=He(e=e.m,r,1);var o=0|(n=Array.isArray(n)?n:B)[M],a=!!(4&o);if(!a){var c=o;0===c&&(c=rt(c,r)),o=n;var l=r;const e=!!(2&(c|=1));e&&(l|=2);let t=!e,i=!0,a=0,u=0;for(;a<o.length;a++){const n=Se(o[a],s,l);if(n instanceof s){if(!e){const e=!!(2&n.m[M]);t&&(t=!e),i&&(i=e)}o[u++]=n}}u<a&&(o.length=u),c|=4,c=i?16|c:-17&c,c=t?8|c:-9&c,o[M]=c,e&&Object.freeze(o),o=c}if(i&&!(8&o||!n.length&&(1===t||4===t&&32&o))){for(Ke(o)&&(n=L(n),o=rt(o,r),r=We(e,r,1,n)),i=n,s=o,o=0;o<i.length;o++)(c=i[o])!==(l=$e(c))&&(i[o]=l);s|=8,s=i.length?-17&s:16|s,o=i[M]=s}let u;if(1===t||4===t&&32&o){if(!Ke(o)){r=o;var d=!!(32&o);(o|=!n.length||16&o&&(!a||d)?2:2048)!==r&&(n[M]=o),Object.freeze(n)}}else a=5===t&&(!!(32&o)||Ke(o)||!!Oe(n)),(2===t||a)&&Ke(o)&&(n=L(n),o=it(o=rt(o,r),r,!1),n[M]=o,r=We(e,r,1,n)),Ke(o)||(e=o,(o=it(o,r,!1))!==e&&(n[M]=o)),a?u=function(e){var t;return void 0===ke&&(ke="function"==typeof Proxy?Re(Proxy):null),(t=!ke)||(void 0===Ae&&(Ae="function"==typeof WeakMap?Re(WeakMap):null),t=!Ae),t?e:(t=Oe(e))?t:Math.random()>.01?e:(function(e){if(void 0===Pe){const e=new ke([],{});Pe=1===Array.prototype.concat.call([],e).length}Pe&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(e[Symbol.isConcatSpreadable]=!0)}(e),function(e,t){(Te||(Te=new Ae)).set(e,t),(Ce||(Ce=new Ae)).set(t,e)}(e,t=new ke(e,{set:(e,t,n)=>(O(),e[t]=n,!0)})),t)}(n):2===t&&(null==(d=Te)||d.delete(n));return u||n}function on(e){return nt(new an,e)}var an=class extends dt{},cn=class extends dt{};function ln(e){return qe(new un,1,ye(e),0)}var un=class extends dt{},dn=class extends dt{},hn=class extends dt{},fn=class extends dt{},pn=class extends dt{getMeetingInfo(){return lt(this,fn,3,gn)}getMeetPlatformInfo(){return lt(this,hn,4,gn)}},gn=[2,3,4,5],mn=class extends dt{},vn=[1,4,5,6,7,8,9,10,11,12,13,14,15,16,17],yn=class extends dt{},wn=class extends dt{},In=new Map([[2,"MAIN_STAGE"],[1,"SIDE_PANEL"]]),bn=new Map([[0,"UNKNOWN"],[1,"OPEN_ADDON"],[2,"START_ACTIVITY"],[3,"JOIN_ACTIVITY"]]);function _n(e){e&&"function"==typeof e.dispose&&e.dispose()}function En(){this.s=this.s,this.g=this.g}function Sn(e,t){e.s?t():(e.g||(e.g=[]),e.g.push(t))}function Tn({J:e,R:t}){if(null===e)throw new Et(Ut("activityStartingState"));if(t||void 0!==e){if("object"!=typeof e)throw new Et(jt("activityStartingState",typeof e,"object"+(t?"":" | undefined")));if(void 0!==e.mainStageUrl&&"string"!=typeof e.mainStageUrl)throw new Et(jt("mainStageUrl",typeof e.mainStageUrl,"string | undefined"));if(void 0!==e.sidePanelUrl&&"string"!=typeof e.sidePanelUrl)throw new Et(jt("sidePanelUrl",typeof e.sidePanelUrl,"string | undefined"));if(void 0!==e.additionalData&&"string"!=typeof e.additionalData)throw new Et(jt("additionalData",typeof e.additionalData,"string | undefined"));if(Object.keys(e).length!==+!!e.mainStageUrl+ +!!e.sidePanelUrl+ +!!e.additionalData)throw new Et(Lt);if(0===Object.keys(e).length)throw new Et(Dt)}}function Cn(e){const t=[];return t.push(nn(tn(en(2),e.mainStageUrl),e.additionalData)),t.push(nn(tn(en(1),e.sidePanelUrl),e.additionalData)),t}En.prototype.s=!1,En.prototype.dispose=function(){this.s||(this.s=!0,this.G())},En.prototype[Symbol.dispose]=function(){this.dispose()},En.prototype.G=function(){if(this.g)for(;this.g.length;)this.g.shift()()};var kn=class extends En{constructor(e){super(),this.context=e,this.h={},Or(this.context.g.U,(e=>{if(7===Je(e.content,vn)){const n=this.h.frameToFrameMessage;if(e=lt(e.content,dn,7,vn),n&&e){var t=ct(e,1);if(void 0===(t=In.get(t)))throw Error("Unknown frame type.");n({originator:t,payload:at(e,2)})}}}))}async getMeetingInfo(){const e=await Jr(this.context.g,ln(2));return{meetingId:at(e.getMeetingInfo(),1),meetingCode:at(e.getMeetingInfo(),2)}}async getFrameOpenReason(){let e;const t=null!=(e=this.context.h.ca)?e:0;let n;return null!=(n=bn.get(t))?n:"UNKNOWN"}async getActivityStartingState(){var e=lt(await Jr(this.context.g,ln(1)),an,2,gn);const t=null==e?void 0:sn(e).find((e=>2===e.getFrameType()));return e=null==e?void 0:sn(e).find((e=>1===e.getFrameType())),{mainStageUrl:(null==t?void 0:at(t,2))||void 0,sidePanelUrl:(null==e?void 0:at(e,2))||void 0,additionalData:(null==e?void 0:at(e,3))||void 0}}async setActivityStartingState(e){Tn({J:e,R:!0});var t=Cn(e);e=Yr;var n=this.context.g,r=new yn;r=et(r,1,t=on(t)),await e(n,r)}on(e,t){this.h[e]=t}async getMeetPlatformInfo(){return{isMeetHardware:st(ge(Be((await Jr(this.context.g,ln(3))).getMeetPlatformInfo(),1)),!1)}}async closeAddon(){await async function(e){var t=Qr,n=new Bn,r=new Nn;n=tt(n,11,Vn,r),await t(e,jr(n))}(this.context.g)}async startActivity(e){Tn({J:e,R:!1});const t=new wn;e&&et(t,1,e=on(e=Cn(e))),await async function(e,t){var n=Qr;t=tt(new Bn,14,Vn,t),await n(e,jr(t))}(this.context.g,t)}async endActivity(e){var t=Xr,n=this.context.g;e=qe(new cn,1,ye("aab61ee0-51b4-475d-aa4d-849f2498640d"===e?999:0),0),await t(n,e)}},An=ft(class extends dt{getFrameOpenReason(){return ct(this,5)}});function Pn(){var e=window.location.href,t=window.location.href,n=new URL(t).searchParams.get("meet_sdk");if(n?t=An(atob(n)):(Zt("meet_sdk",t),t=void 0),(n=at(t,1))||Zt("meet_addon_frame_type",e),2!==(n=Number(n))&&1!==n)throw new Et(Pt);const r=at(t,2);r||Zt("meet_control_channel_name",e);const i=at(t,4);var s;return i||Zt("addon_cloud_project_number",e),{ca:e=null!=(s=t.getFrameOpenReason())?s:0,frameType:n,ba:r,cloudProjectNumber:i,S:s=at(t,3)||"https://meet.google.com"}}var Nn=class extends dt{},On=class extends dt{},Rn=class extends dt{},Dn=[1,2],Ln=class extends dt{},xn=class extends dt{},Mn=class extends dt{},Un=class extends dt{},jn=class extends dt{},Fn=class extends dt{setAddonStartingState(e){return et(this,1,e)}},$n=class extends dt{},Bn=class extends dt{},Vn=[1,2,5,6,7,8,9,10,11,13,14,15,16],Hn=class extends dt{},zn=ft(Hn),Wn=[1,2];class Gn{constructor(e,t){this.data=e,this.channel=t}}var Kn=Promise;function qn(e){const t=new MessageChannel;return Xn(t.port1,e),t}function Jn(e,t){return Xn(e,t),new Yn(e)}class Yn{constructor(e){this.g=e}send(e,t,n=[]){t=qn(t),this.g.postMessage(e,[t.port2].concat(n))}C(e,t){return new Kn((n=>{this.send(e,n,t)}))}}function Xn(e,t){t&&(e.onmessage=e=>{var n=e.data;e=Jn(e.ports[0]),t(new Gn(n,e))})}var Qn="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function Zn(e,t){e.l(t),e.h<100&&(e.h++,t.next=e.g,e.g=t)}class er{constructor(e,t){this.j=e,this.l=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.j(),e}}function tr(){var e=or;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var nr=new er((()=>new rr),(e=>e.reset()));class rr{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let ir,sr=!1,or=new class{constructor(){this.h=this.g=null}add(e,t){const n=nr.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},ar=(e,t)=>{ir||cr(),sr||(ir(),sr=!0),or.add(e,t)},cr=()=>{const e=Promise.resolve(void 0);ir=()=>{e.then(lr)}};function lr(){let e;for(;e=tr();){try{e.h.call(e.g)}catch(e){a(e)}Zn(nr,e)}sr=!1}function ur(){}function dr(e){if(this.g=0,this.T=void 0,this.l=this.h=this.j=null,this.v=this.B=!1,e!=ur)try{const t=this;e.call(void 0,(function(e){yr(t,2,e)}),(function(e){yr(t,3,e)}))}catch(e){yr(this,3,e)}}function hr(){this.next=this.context=this.h=this.l=this.g=null,this.j=!1}hr.prototype.reset=function(){this.context=this.h=this.l=this.g=null,this.j=!1};var fr=new er((function(){return new hr}),(function(e){e.reset()}));function pr(e,t,n){const r=fr.get();return r.l=e,r.h=t,r.context=n,r}function gr(e,t){(t=pr(t=Qn(t),t)).j=!0,vr(e,t)}function mr(e,t){if(0==e.g)if(e.j){var n=e.j;if(n.h){var r=0,i=null,s=null;for(let t=n.h;t&&(t.j||(r++,t.g==e&&(i=t),!(i&&r>1)));t=t.next)i||(s=t);i&&(0==n.g&&1==r?mr(n,t):(s?((r=s).next==n.l&&(n.l=r),r.next=r.next.next):Ir(n),br(n,i,3,t)))}e.j=null}else yr(e,3,t)}function vr(e,t){e.h||2!=e.g&&3!=e.g||wr(e),e.l?e.l.next=t:e.h=t,e.l=t}function yr(e,t,n){if(0==e.g){e===n&&(t=3,n=new TypeError("Promise cannot resolve to itself")),e.g=1;e:{var r=n,i=e.ma,s=e.na;if(r instanceof dr){vr(r,pr(i||ur,s||null,e));var o=!0}else{if(r)try{var a=!!r.$goog_Thenable}catch(e){a=!1}else a=!1;if(a)r.then(i,s,e),o=!0;else{if("object"==(a=typeof r)&&null!=r||"function"==a)try{const t=r.then;if("function"==typeof t){!function(e,t,n,r,i){function s(e){o||(o=!0,r.call(i,e))}let o=!1;try{t.call(e,(function(e){o||(o=!0,n.call(i,e))}),s)}catch(e){s(e)}}(r,t,i,s,e),o=!0;break e}}catch(t){s.call(e,t),o=!0;break e}o=!1}}}o||(e.T=n,e.g=t,e.j=null,wr(e),3!=t||n instanceof Sr||function(e,t){e.v=!0,ar((function(){e.v&&Er.call(null,t)}))}(e,n))}}function wr(e){e.B||(e.B=!0,ar(e.la,e))}function Ir(e){let t=null;return e.h&&(t=e.h,e.h=t.next,t.next=null),e.h||(e.l=null),t}function br(e,t,n,r){if(3==n&&t.h&&!t.j)for(;e&&e.v;e=e.j)e.v=!1;if(t.g)t.g.j=null,_r(t,n,r);else try{t.j?t.l.call(t.context):_r(t,n,r)}catch(e){Er.call(null,e)}Zn(fr,t)}function _r(e,t,n){2==t?e.l.call(e.context,n):e.h&&e.h.call(e.context,n)}dr.prototype.then=function(e,t,n){return function(e,t,n,r){const i=pr(null,null,null);return i.g=new dr((function(e,s){i.l=t?function(n){try{const i=t.call(r,n);e(i)}catch(e){s(e)}}:e,i.h=n?function(t){try{const i=n.call(r,t);void 0===i&&t instanceof Sr?s(t):e(i)}catch(e){s(e)}}:s})),i.g.j=e,vr(e,i),i.g}(this,Qn("function"==typeof e?e:null),Qn("function"==typeof t?t:null),n)},dr.prototype.$goog_Thenable=!0,dr.prototype.cancel=function(e){if(0==this.g){const t=new Sr(e);ar((function(){mr(this,t)}),this)}},dr.prototype.ma=function(e){this.g=0,yr(this,2,e)},dr.prototype.na=function(e){this.g=0,yr(this,3,e)},dr.prototype.la=function(){let e;for(;e=Ir(this);)br(this,e,this.g,this.T);this.B=!1};var Er=a;function Sr(e){o.call(this,e)}function Tr(e,t,n){this.promise=e,this.resolve=t,this.reject=n}s(Sr,o),Sr.prototype.name="cancel";let Cr=1,kr=new WeakMap;function Ar(e,t,n){var r=Nr;e.h.has(t),r(t,n)}var Pr=class extends En{constructor(){super(),this.h=new Set}signal(){const e=new Rr;return this.h.add(e),Sn(this,function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}(_n,e)),e}};function Nr(e,t){return new Promise((n=>{xr((()=>{e.L&&(e.ea=t,e.P=!0);for(const{I:n,slot:r}of e.o.values())try{r(t,{signal:e,I:n})}catch(e){a(e)}for(const n of e.A)n.resolve(t);e.A.clear(),n()}))}))}function Or(e,t,n){const r=Cr++;return xr((()=>{!function(e,t,n,r){if(!e.s)if(r){if(!r.s){const i=()=>{xr((()=>{e.o.delete(t);const n=kr.get(r);n&&y(n,i)}))};e.o.set(t,{I:t,slot:n,F:i}),Ur(r,i)}}else e.o.set(t,{I:t,slot:n,F:()=>e.o.delete(t)})}(e,r,t,n)})),r}var Rr=class extends En{constructor(){super(),this.L=!1,this.o=new Map,this.A=new Set,this.P=!1}detach(e){xr((()=>{const t=this.o.get(e);t&&t.F()}))}value(e){return this.promise(!0,e)}next(e){return this.promise(!1,e)}promise(e,t){const n=function(){let e,t;return new Tr(new dr((function(n,r){e=n,t=r})),e,t)}();return xr((()=>{if(this.s)n.reject(new Sr("Signal initially disposed"));else if(t&&t.s)n.reject(new Sr("Owner initially disposed"));else if(e&&this.L&&this.P)n.resolve(this.ea);else if(this.A.add(n),gr(n.promise,(()=>{this.A.delete(n)})),t){const e=()=>{n.reject(new Sr("Owner asynchronously disposed"))};gr(n.promise,(()=>{const n=kr.get(t);n&&y(n,e)})),Ur(t,e)}})),n.promise}G(){super.G(),xr((()=>{for(const{F:e}of this.o.values())e();this.o.clear();for(const e of this.A)e.reject(new Sr("Signal asynchronously disposed"));this.A.clear()}))}};const Dr=[];let Lr=!1;function xr(e){Dr.push(e),async function(){if(!Lr)try{Lr=!0;let e=Mr(0);for(;e<Dr.length;)await Promise.resolve(),e=Mr(e)}catch(e){a(e)}finally{Dr.length=0,Lr=!1}}()}function Mr(e){const t=e+100;for(;e<t&&e<Dr.length;)try{Dr[e++]()}catch(e){a(e)}return e}function Ur(e,t){if(e.s)t();else{var n=kr.get(e);if(n)n.push(t);else{const n=[t];kr.set(e,n),Sn(e,(()=>{for(const e of[...n])e();kr.delete(e)}))}}}function jr(e){return{content:ut(e=tt(new Hn,1,Wn,e))}}const Fr=new Pr;function $r(e,t){const n=Fr.signal();return{channel:Jn(e,(e=>{const r=t(e.data);Ar(Fr,n,{content:r,ka:e})})),signal:n}}let Br;var Vr=class extends dt{},Hr=class extends dt{},zr=class extends dt{h(){return lt(this,Vr,2,Wr)}g(){return Ge(this,Vr,2,Wr)}j(){return lt(this,Hr,3,Wr)}l(){return Ge(this,Hr,3,Wr)}},Wr=[2,3],Gr=ft(class extends dt{}),Kr=ft(class extends dt{}),qr=[1,2];async function Jr(e,t){var n=Qr;let r;return t=tt(new Bn,9,Vn,t),e=await n(e,jr(t)),null==(r=lt(zn(e.data.content),mn,2,Wn))?void 0:lt(r,pn,9,vn)}async function Yr(e,t){var n=Qr;t=tt(new Bn,8,Vn,t),await n(e,jr(t))}async function Xr(e,t){var n=Qr;t=tt(new Bn,15,Vn,t),await n(e,jr(t))}async function Qr(e,t){let n;(e=await e.channel.C(t))||Qt(St,`Falsy response received from the message channel. ${JSON.stringify(e)}`),(t=e.data)||Qt(St,`Data field in the response from the message channel is falsy. ${JSON.stringify(t)}`),(t=t.content)||Qt(St,`Content field in the response from the message channel is falsy. ${JSON.stringify(t)}`);try{n=zn(t)}catch(e){Qt(St,`The ControlMessage can't be deserialized. ${JSON.stringify(t)}. ${JSON.stringify(e)}`)}if((t=lt(n,mn,2,Wn))||Qt(St,`MeetToAddonMessage field on ControlMessage is falsy. ${JSON.stringify(t)}`),void 0!==(null==(t=null==t?void 0:lt(t,_t,10,vn))?void 0:ct(t,1)))throw new Et(function(e){switch(e){case 0:default:return St;case 1:return Ot;case 2:return Rt;case 3:return Ft;case 4:return $t;case 5:return Vt;case 6:return At;case 7:return Ht;case 8:return zt;case 9:return Wt;case 10:return Kt;case 11:return qt;case 12:return Jt;case 13:return Yt;case 14:return Bt;case 15:return Xt}}(ct(t,1)));return e}async function Zr(e){const t=function(){var e=new Rn,t=new On;return tt(e,1,Dn,t)}(),{channel:n,response:r}=await async function(e,t){var n,r=Qr;return t=tt(new Bn,1,Vn,t),e=(r=await r(e,jr(t))).data.messagePort,n=null!=(r=null==(n=lt(zn(r.data.content),mn,2,Wn))?void 0:lt(n,It,1,vn))?r:qe(n=new It,1,ye(0),0),{channel:e?$r(e,(e=>Kr(e))):void 0,response:n}}(e,t);if(!n)throw new Et(function(e){let t;var n=null!=(t=ct(e,1))?t:0;switch(e=function(e){switch(e){case 2:return"co";case 3:return"gd";default:return"unknown"}}(Je(e,bt)),n){case 1:return{errorType:"InternalError",message:`Could not connect to ${e} channel. Meet did not respond with a MessagePort.`,i:"No further information is available."};case 2:return{errorType:"InternalError",message:`Could not connect to ${e}. A conflicting ${e} exists.`,i:"No further information is available."};case 3:return{errorType:"InternalError",message:`Could not connect to ${e} channel. The addon does not have permission to open a ${e}.`,i:"This method might require EAP enrollment."};case 4:return{errorType:"InternalError",message:`Could not connect to ${e} channel. The addon is not authorized for this ${e}.`,i:"No further information is available."};case 0:default:return(e=>({errorType:"InternalError",message:`Could not connect to ${e} channel. Unknown error`,i:"No further information is available."}))(e);case 5:return"co"===e?{errorType:"InternalError",message:`Could not connect to ${e} channel. The coActivity was not found.`,i:`Consider starting the ${e} only after after the startActivity promise returns.`}:{errorType:"InternalError",message:`Could not connect to ${e} channel.`,i:"No further information is available."}}}(r));return n}async function ei(e,t,n){var r=Qr,i=new Bn;t=qe(new Mn,1,ye(t),0),n=qe(t,2,Ee(n),""),i=tt(i,7,Vn,n),await r(e,jr(i))}class ti extends En{constructor(e,t,n){super(),this.U=e,this.channel=t,this.h=function(e){var t=new wt(100),n=Promise.resolve();return(...r)=>vt(t)?e(...r):n}((async()=>{var e=this.channel,t=e.C,n=new Bn,r=new Un;n=tt(n,13,Vn,r),await t.call(e,jr(n))})),e=function(){var e=Br||(Br=gt("[1,2,0]"));const t=(e=ze(e=$e(e),4,Ee("dev-706864954"))).m,n=t[M];return 2&n?e:new e.constructor(Fe(t,n,!0))}(),at(e,4),we(Be(e,1)),we(Be(e,2)),we(Be(e,3)),n=function(e,t){return tt(e,2,Vn,t)}(new Bn,function(e,t){return qe(e,3,Ee(t),"")}(function(e){return et(new Ln,2,e)}(e),n)),this.channel.send(jr(n)),Or(this.U,(async e=>{16===Je(e.content,vn)&&await async function(e){await e.h()}(this)}))}}let ni;var ri=class{constructor(e){var t=ni;this.h=e,this.g=t}delete(){throw Error("Not implemented.")}},ii=class extends dt{h(){return lt(this,Vr,2,si)}g(){return Ge(this,Vr,2,si)}j(){return lt(this,Hr,3,si)}l(){return Ge(this,Hr,3,si)}},si=[2,3],oi=class extends dt{},ai=class extends dt{},ci=class extends dt{},li=class extends dt{h(){return lt(this,Vr,2,ui)}g(){return Ge(this,Vr,2,ui)}j(){return lt(this,Hr,3,ui)}l(){return Ge(this,Hr,3,ui)}},ui=[2,3],di=[5,6],hi=class extends dt{},fi=class extends dt{},pi=[1,2,3],gi=class extends Error{constructor(){super("Failed to create CoActivity: Connection refused - Meet refused to begin Live Sharing")}},mi=class{constructor(e){this.config=e}start(){return null!=this.g||(this.g=setInterval((()=>{this.config.ha()}),this.config.da)),this}shutdown(){clearInterval(this.g)}};function vi(){const e=new Map,t={set:(n,r)=>(e.set(n,r),t),D:()=>e};return t}function yi(e){if(e.g()){var t=(e=e.h().m)[M],n=He(e,t,1),r=G(n,!0);if(null!=r&&r!==n&&We(e,t,1,r),t=null==(e=r)?T():e,e=Uint8Array,P(S),null!=(n=t.g)&&!E(n))if("string"==typeof n){I.test(n)&&(n=n.replace(I,_)),n=atob(n),r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);n=r}else n=null;return{bytes:new e((t=null==n?n:t.g=n)||0)}}}function wi(e,t){return t=bi(t),tt(e,2,ui,t),e}function Ii(e,t){return t=bi(t),tt(e,2,si,t),e}function bi(e){return qe(new Vr,1,G(e.bytes,!1),T())}function _i(e){if(e.l()){var t,n,r=at(e=e.j(),1),i=null!=(n=null==(t=Ze(e,mt,2))?void 0:ot(t))?n:0;let s=(n=e.m)[M];const o=He(n,s,4);return null!=(t=null==o||"number"==typeof o?o:"NaN"===o||"Infinity"===o||"-Infinity"===o?Number(o):void 0)&&t!==o&&We(n,s,4,t),{mediaId:r,mediaPlayoutPosition:i,mediaPlayoutRate:st(t,0),playbackState:Ti.get(ct(e,3))}}}function Ei(e,t){return t=ki(t),tt(e,3,ui,t),e}function Si(e,t){return t=ki(t),tt(e,3,si,t),e}const Ti=vi().set(0,"INVALID").set(1,"BUFFERING").set(2,"PLAY").set(3,"PAUSE").set(4,"ENDED").D(),Ci=vi().set("INVALID",0).set("BUFFERING",1).set("PLAY",2).set("PAUSE",3).set("ENDED",4).D();function ki(e){var t=new Hr;t=qe(t,1,Ee(e.mediaId),"");var n=e.mediaPlayoutRate;if(null!=n&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);return t=qe(t,4,n,0),n=qe(n=new mt,1,Ie(e.mediaPlayoutPosition),"0"),qe(t=et(t,2,n),3,ye(e=Ci.get(e.playbackState)),0)}function Ai(e,t){return t=qe(new ai,1,ye(t.u),0),tt(e,6,di,t),e}function Pi(e){var t=new oi;return tt(e,5,di,t),e}const Ni=vi().set("co-doing",1).set("co-watching",2).D();async function Oi(e,t,n){var r=t.C,i=new fi,s=new hi;let o;if(s=qe(s,1,Ee(e.activityTitle),""),s=qe(s,2,ye(Ni.get(e.K)),0),i=tt(i,3,pi,s),null!=(o=st(ge(Be(r=await r.call(t,i,Gr),1)),!1))&&o)return new Li(e,t,n,Ze(r,zr,2));throw new gi}function Ri(e,t){const n=e.config.N(t);n&&!e.config.M(e.g,n)&&(e.g=n,e.j=ot(t),e.v(e.g))}function Di(e,t){const{state:n,fa:r,context:i}=t(e.g);e.g=n,e.notify(e.g,i,r)}class Li{constructor(e,t,n,r){this.l=e,this.h=t,this.config=n,this.v=function(e){var t=new wt(500);let n,r=0;return(...i)=>{vt(t)?e(...i):(n=()=>{e(...i)},r||(r=setTimeout((()=>{let e;r=0,null==(e=n)||e()}),function(e){const t=e.g;return(e=yt(e,e.index))>=t?0:t-e}(t))))}}((e=>{this.l.O(e)})),function(e,t){const n=Or(e.signal,(e=>{t(e)}));e.o.push(n)}(this.h,(e=>{const t=Je(e,qr);switch(t){case 1:Ri(this,lt(e,zr,1,qr));break;case 2:case 0:console.warn(`IllegalMessage: ${t} - Unhandled message - Please raise a bug with the MeetJS team`)}})),this.B=new mi({da:1e3,ha:()=>{var e,t,n=null==(t=(e=this.l).ja)?void 0:t.call(e);if(null!==this.g){this.g={...this.g,...n},e=new fi,n=(t=this.config).W;var r=new ii;r=qe(r,1,Ie(this.j),"0"),t=n.call(t,r,this.g),e=tt(e,1,pi,t),this.h.send(e)}}}).start(),this.g=null,this.j=0,r&&Ri(this,r)}disconnect(){this.h.shutdown(),this.B.shutdown()}notify(e,t,n){var r=n?function({activityTitle:e}){return ze(new ci,4,Ee(e))}(n):void 0,i=(n=this.config).X,s=new li;r=et(s=qe(s,1,Ie(this.j),"0"),4,r),e=i.call(n,r,e),e=this.config.V(e,t),n=(t=this.h).send,e=tt(i=new fi,2,pi,e),n.call(t,e)}}var xi=class{constructor(e){this.g=e}broadcastStateUpdate(e){Di(this.g,(()=>({state:e,context:{}})))}disconnect(){this.g.disconnect()}};function Mi(e,t){return null!=e&&null!=t&&e.bytes.length===t.bytes.length&&e.bytes.every(((e,n)=>e===t.bytes[n]))}var Ui=class{constructor(e){this.g=e}notifySwitchedToMedia(e,t,n){Di(this.g,(()=>({state:{mediaId:t,mediaPlayoutRate:1,mediaPlayoutPosition:n,playbackState:"PLAY"},fa:{activityTitle:e},context:{u:1}})))}notifyPauseState(e,t){Di(this.g,(n=>{if(null==n)throw Error("Invalid before coWatchingState");return{state:{...n,playbackState:e?"PAUSE":"PLAY",mediaPlayoutPosition:t},context:{u:3}}}))}notifySeekToTimestamp(e){Di(this.g,(t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e},context:{u:2}}}))}notifyPlayoutRate(e){Di(this.g,(t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutRate:e},context:{u:4}}}))}notifyBuffering(e){Di(this.g,(t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e,playbackState:"BUFFERING"},context:{u:3}}}))}notifyReady(e){Di(this.g,(t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e},context:{u:3}}}))}disconnect(){this.g.disconnect()}};function ji(e,t){if(null==e||null==t)return!1;const n="PLAY"===e.playbackState?3*Math.max(e.mediaPlayoutRate,1):0,r=Math.abs(e.mediaPlayoutPosition-t.mediaPlayoutPosition);return e.mediaId===t.mediaId&&e.mediaPlayoutRate===t.mediaPlayoutRate&&r<=n&&e.playbackState===t.playbackState}var Fi=class{constructor(e,t){this.channel=e,this.signal=t,this.o=[]}send(e){this.channel.send(ut(e))}async C(e,t){return t((e=await this.channel.C(ut(e))).data)}shutdown(){this.o.forEach((e=>{this.signal.detach(e)}))}};async function $i(e){const t=new Pr,n=t.signal();!function(e,t,n,r=e=>e){Or(n,(n=>{Ar(e,t,r(n))}),e)}(t,n,(e=await e).signal,(e=>e.content));const{ia:r,ga:i}=function(e,t){var n=Bi;const r=e.signal(),i=e.signal();return Or(t,(t=>{const s=n(t)?r:i;Ar(e,s,t)}),e),{ia:r,ga:i}}(t,n);return{Z:new Fi(e.channel,r),aa:new Fi(e.channel,i)}}function Bi(e){if(1!==Je(e,qr))throw Error("CA Message arrived with no known content message set");return(e=lt(e,zr,1,qr)).g()}var Vi=class extends kn{async notifySidePanel(e){await ei(this.context.g,1,e)}async unloadSidePanel(){await async function(e){var t=Qr,n=new Bn,r=new $n;n=tt(n,5,Vn,r),await t(e,jr(n))}(this.context.g)}async loadSidePanel(){await async function(e){var t=Qr,n=new Bn,r=new xn;n=tt(n,6,Vn,r),await t(e,jr(n))}(this.context.g)}},Hi=class extends kn{async setAddonStartingState(e){if(null===e)throw new Et(Ut("addonStartingState"));if("object"!=typeof e)throw new Et(jt("addonStartingState",typeof e,"object | undefined"));if(void 0!==e.sidePanelUrl&&"string"!=typeof e.sidePanelUrl)throw new Et(jt("sidePanelUrl",typeof e.sidePanelUrl,"string | undefined"));if(void 0!==e.additionalData&&"string"!=typeof e.additionalData)throw new Et(jt("additionalData",typeof e.additionalData,"string | undefined"));if(Object.keys(e).length!==+!!e.sidePanelUrl+ +!!e.additionalData)throw new Et(Mt);if(0===Object.keys(e).length)throw new Et(xt);var t=[];t.push(nn(tn(en(1),e.sidePanelUrl),e.additionalData)),e=this.context.g;var n=new Fn,r=n.setAddonStartingState;t=nt(new jn,t),await async function(e,t){var n=Qr;t=tt(new Bn,16,Vn,t),await n(e,jr(t))}(e,r.call(n,t))}},zi=class extends kn{async notifyMainStage(e){await ei(this.context.g,2,e)}},Wi=class{constructor(e){e=e.cloudProjectNumber;const t=Pn();if(t.cloudProjectNumber!==e)throw new Et(Nt);const n=t.S,r=t.ba;let i;ni=null!=(i=ni)?i:function(e,t,n){const r=new Pr,i=r.signal();return e=(({destination:e,origin:t,ra:n,Y:r="ZNWN1d",onMessage:i})=>{if("*"===t)throw Error("Sending to wildcard origin not allowed.");const s=qn(i);return e.postMessage(n?{n:r,t:n}:r,t,[s.port2]),Jn(s.port1,i)})({destination:window.parent,origin:t,Y:e,onMessage:e=>{const t=zn(e.data.content);2===Je(t,Wn)&&Ar(r,i,{content:lt(t,mn,2,Wn),ka:e,messagePort:e.data.messagePort})}}),new ti(i,e,n)}(r,n,e),this.g=new ri(t)}async createMainStageClient(){var e=this.g;if(2!==e.h.frameType)throw new Et(Ct);return await Promise.resolve(new Vi(e))}async createSidePanelClient(){var e=this.g;if(1!==e.h.frameType)throw new Et(kt);return await Promise.resolve(new zi(e))}async createCoWatchingClient(e){return await async function(e,t){if(({aa:e}=await $i(Zr(e.g))),t=await async function(e,t){if(t)return e=await Oi({activityTitle:t.activityTitle,K:"co-watching",ja:()=>t.onCoWatchingStateQuery(),O:e=>{t.onCoWatchingStateChanged(e)}},e,{X:Ei,W:Si,V:Ai,N:_i,M:ji}),new Ui(e)}(e,t),!t)throw Error("Failed to create co-watching session");return t}(this.g,e)}async createCoDoingClient(e){return await async function(e,t){if(({Z:e}=await $i(Zr(e.g))),t=await async function(e,t){if(t)return e=await Oi({activityTitle:t.activityTitle,K:"co-doing",O:e=>{t.onCoDoingStateChanged(e)}},e,{X:wi,W:Ii,V:Pi,N:yi,M:Mi}),new xi(e)}(e,t),!t)throw Error("Failed to create co-doing session");return t}(this.g,e)}async createRoomsStandaloneClient(){var e=this.g;if(2!==e.h.frameType)throw new Et(Ct);return await Promise.resolve(new Hi(e))}};let Gi=null;var Ki,qi={addon:{getFrameType:function(){e:{var e=Pn().frameType;switch(e){case 2:e="MAIN_STAGE";break e;case 1:e="SIDE_PANEL";break e;default:throw Error(`Unknown frame type: ${e}`)}}return e},createAddonSession:async function(e){if(null===e)throw new Et(Ut("config"));if("object"!=typeof e)throw new Et(jt("config",typeof e,"object"));if("string"!=typeof e.cloudProjectNumber)throw new Et(jt("cloudProjectNumber",typeof e.cloudProjectNumber,"string"));if(Gi&&"integration.test.google.com"!==Pn().S)throw new Et(Gt);return Gi=new Wi(e)}}},Ji=["meet"],Yi=i;Ji[0]in Yi||void 0===Yi.execScript||Yi.execScript("var "+Ji[0]);for(;Ji.length&&(Ki=Ji.shift());)Ji.length||void 0===qi?Yi=Yi[Ki]&&Yi[Ki]!==Object.prototype[Ki]?Yi[Ki]:Yi[Ki]={}:Yi[Ki]=qi}).apply(t);const n=t.meet,r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|o>>4;let d=(15&o)<<2|c>>6,h=63&c;a||(h=64,s||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==a||null==c)throw new s;const l=i<<2|o>>4;if(r.push(l),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(e){return function(e){const t=r(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},a=function(e){try{return i.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},c=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&a(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},l=()=>{var e;return null===(e=c())||void 0===e?void 0:e.config},u=e=>{var t;return null===(t=c())||void 0===t?void 0:t[`_${e}`]};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function p(){try{return"object"==typeof indexedDB}catch(e){return!1}}function g(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class m extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,v.prototype.create)}}class v{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(y,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new m(r,o,n)}}const y=/\{\$([^}]+)}/g;function w(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(I(n)&&I(s)){if(!w(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function I(e){return null!==e&&"object"==typeof e}function b(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function _(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function E(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class S{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=T),void 0===r.error&&(r.error=T),void 0===r.complete&&(r.complete=T);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}function C(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function k(e){return e&&e._delegate?e._delegate:e}class A{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const P="[DEFAULT]";class N{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new d;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:P})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=P){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=P){return this.instances.has(e)}getOptions(e=P){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===P?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=P){return this.component?this.component.multipleInstances?e:P:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class O{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new N(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const R=[];var D;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(D||(D={}));const L={debug:D.DEBUG,verbose:D.VERBOSE,info:D.INFO,warn:D.WARN,error:D.ERROR,silent:D.SILENT},x=D.INFO,M={[D.DEBUG]:"log",[D.VERBOSE]:"log",[D.INFO]:"info",[D.WARN]:"warn",[D.ERROR]:"error"},U=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=M[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class j{constructor(e){this.name=e,this._logLevel=x,this._logHandler=U,this._userLogHandler=null,R.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in D))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?L[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,D.DEBUG,...e),this._logHandler(this,D.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,D.VERBOSE,...e),this._logHandler(this,D.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,D.INFO,...e),this._logHandler(this,D.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,D.WARN,...e),this._logHandler(this,D.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,D.ERROR,...e),this._logHandler(this,D.ERROR,...e)}}let F,$;const B=new WeakMap,V=new WeakMap,H=new WeakMap,z=new WeakMap,W=new WeakMap;let G={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return V.get(e);if("objectStoreNames"===t)return e.objectStoreNames||H.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return q(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function K(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($||($=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(J(this),e),q(B.get(this))}:function(...e){return q(t.apply(J(this),e))}:function(e,...n){const r=t.call(J(this),e,...n);return H.set(r,e.sort?e.sort():[e]),q(r)}:(e instanceof IDBTransaction&&function(e){if(V.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));V.set(e,t)}(e),n=e,(F||(F=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,G):e);var t,n}function q(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(q(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&B.set(t,e)})).catch((()=>{})),W.set(t,e),t}(e);if(z.has(e))return z.get(e);const t=K(e);return t!==e&&(z.set(e,t),W.set(t,e)),t}const J=e=>W.get(e);function Y(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=q(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(q(o.result),e.oldVersion,e.newVersion,q(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const X=["get","getKey","getAll","getAllKeys","count"],Q=["put","add","delete","clear"],Z=new Map;function ee(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Z.get(t))return Z.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Q.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!X.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return Z.set(t,s),s}var te;te=G,G={...te,get:(e,t,n)=>ee(e,t)||te.get(e,t,n),has:(e,t)=>!!ee(e,t)||te.has(e,t)};class ne{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const re="@firebase/app",ie="0.11.5",se=new j("@firebase/app"),oe="@firebase/app-compat",ae="@firebase/analytics-compat",ce="@firebase/analytics",le="@firebase/app-check-compat",ue="@firebase/app-check",de="@firebase/auth",he="@firebase/auth-compat",fe="@firebase/database",pe="@firebase/data-connect",ge="@firebase/database-compat",me="@firebase/functions",ve="@firebase/functions-compat",ye="@firebase/installations",we="@firebase/installations-compat",Ie="@firebase/messaging",be="@firebase/messaging-compat",_e="@firebase/performance",Ee="@firebase/performance-compat",Se="@firebase/remote-config",Te="@firebase/remote-config-compat",Ce="@firebase/storage",ke="@firebase/storage-compat",Ae="@firebase/firestore",Pe="@firebase/vertexai",Ne="@firebase/firestore-compat",Oe="firebase",Re="[DEFAULT]",De={[re]:"fire-core",[oe]:"fire-core-compat",[ce]:"fire-analytics",[ae]:"fire-analytics-compat",[ue]:"fire-app-check",[le]:"fire-app-check-compat",[de]:"fire-auth",[he]:"fire-auth-compat",[fe]:"fire-rtdb",[pe]:"fire-data-connect",[ge]:"fire-rtdb-compat",[me]:"fire-fn",[ve]:"fire-fn-compat",[ye]:"fire-iid",[we]:"fire-iid-compat",[Ie]:"fire-fcm",[be]:"fire-fcm-compat",[_e]:"fire-perf",[Ee]:"fire-perf-compat",[Se]:"fire-rc",[Te]:"fire-rc-compat",[Ce]:"fire-gcs",[ke]:"fire-gcs-compat",[Ae]:"fire-fst",[Ne]:"fire-fst-compat",[Pe]:"fire-vertex","fire-js":"fire-js",[Oe]:"fire-js-all"},Le=new Map,xe=new Map,Me=new Map;function Ue(e,t){try{e.container.addComponent(t)}catch(n){se.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function je(e){const t=e.name;if(Me.has(t))return se.debug(`There were multiple attempts to register component ${t}.`),!1;Me.set(t,e);for(const t of Le.values())Ue(t,e);for(const t of xe.values())Ue(t,e);return!0}function Fe(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function $e(e){return null!=e&&void 0!==e.settings}const Be=new v("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Ve{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new A("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Be.create("app-deleted",{appName:this._name})}}const He="11.6.1";function ze(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:Re,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Be.create("bad-app-name",{appName:String(i)});if(n||(n=l()),!n)throw Be.create("no-options");const s=Le.get(i);if(s){if(w(n,s.options)&&w(r,s.config))return s;throw Be.create("duplicate-app",{appName:i})}const o=new O(i);for(const e of Me.values())o.addComponent(e);const a=new Ve(n,r,o);return Le.set(i,a),a}function We(e=Re){const t=Le.get(e);if(!t&&e===Re&&l())return ze();if(!t)throw Be.create("no-app",{appName:e});return t}function Ge(e,t,n){var r;let i=null!==(r=De[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void se.warn(e.join(" "))}je(new A(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Ke="firebase-heartbeat-store";let qe=null;function Je(){return qe||(qe=Y("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ke)}catch(e){console.warn(e)}}}).catch((e=>{throw Be.create("idb-open",{originalErrorMessage:e.message})}))),qe}async function Ye(e,t){try{const n=(await Je()).transaction(Ke,"readwrite"),r=n.objectStore(Ke);await r.put(t,Xe(e)),await n.done}catch(e){if(e instanceof m)se.warn(e.message);else{const t=Be.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});se.warn(t.message)}}}function Xe(e){return`${e.name}!${e.options.appId}`}class Qe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new et(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ze();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){se.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Ze(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),tt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),tt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=o(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return se.warn(e),""}}}function Ze(){return(new Date).toISOString().substring(0,10)}class et{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!p()&&g().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Je()).transaction(Ke),n=await t.objectStore(Ke).get(Xe(e));return await t.done,n}catch(e){if(e instanceof m)se.warn(e.message);else{const t=Be.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});se.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ye(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function tt(e){return o(JSON.stringify({version:2,heartbeats:e})).length}je(new A("platform-logger",(e=>new ne(e)),"PRIVATE")),je(new A("heartbeat",(e=>new Qe(e)),"PRIVATE")),Ge(re,ie,""),Ge(re,ie,"esm2017"),Ge("fire-js",""),Ge("firebase","11.6.1","app");const nt="@firebase/installations",rt="0.6.13",it=`w:${rt}`,st="FIS_v2",ot=new v("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function at(e){return e instanceof m&&e.code.includes("request-failed")}function ct({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function lt(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function ut(e,t){const n=(await t.json()).error;return ot.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function dt({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function ht(e){const t=await e();return t.status>=500&&t.status<600?e():t}function ft(e){return new Promise((t=>{setTimeout(t,e)}))}const pt=/^[cdef][\w-]{21}$/;function gt(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return pt.test(t)?t:""}catch(e){return""}}function mt(e){return`${e.appName}!${e.appId}`}const vt=new Map;function yt(e,t){const n=mt(e);wt(n,t),function(e,t){const n=(!It&&"BroadcastChannel"in self&&(It=new BroadcastChannel("[Firebase] FID Change"),It.onmessage=e=>{wt(e.data.key,e.data.fid)}),It);n&&n.postMessage({key:e,fid:t}),0===vt.size&&It&&(It.close(),It=null)}(n,t)}function wt(e,t){const n=vt.get(e);if(n)for(const e of n)e(t)}let It=null;const bt="firebase-installations-store";let _t=null;function Et(){return _t||(_t=Y("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(bt)}})),_t}async function St(e,t){const n=mt(e),r=(await Et()).transaction(bt,"readwrite"),i=r.objectStore(bt),s=await i.get(n);return await i.put(t,n),await r.done,s&&s.fid===t.fid||yt(e,t.fid),t}async function Tt(e){const t=mt(e),n=(await Et()).transaction(bt,"readwrite");await n.objectStore(bt).delete(t),await n.done}async function Ct(e,t){const n=mt(e),r=(await Et()).transaction(bt,"readwrite"),i=r.objectStore(bt),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.done,!o||s&&s.fid===o.fid||yt(e,o.fid),o}async function kt(e){let t;const n=await Ct(e.appConfig,(n=>{const r=function(e){return Nt(e||{fid:gt(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(ot.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=ct(e),i=dt(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={fid:n,authVersion:st,appId:e.appId,sdkVersion:it},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await ht((()=>fetch(r,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:lt(e.authToken)}}throw await ut("Create Installation",c)}(e,t);return St(e.appConfig,n)}catch(n){throw at(n)&&409===n.customData.serverCode?await Tt(e.appConfig):await St(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:At(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function At(e){let t=await Pt(e.appConfig);for(;1===t.registrationStatus;)await ft(100),t=await Pt(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await kt(e);return n||t}return t}function Pt(e){return Ct(e,(e=>{if(!e)throw ot.create("installation-not-found");return Nt(e)}))}function Nt(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Ot({appConfig:e,heartbeatServiceProvider:t},n){const r=function(e,{fid:t}){return`${ct(e)}/${t}/authTokens:generate`}(e,n),i=function(e,{refreshToken:t}){const n=dt(e);return n.append("Authorization",function(e){return`${st} ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={installation:{sdkVersion:it,appId:e.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await ht((()=>fetch(r,a)));if(c.ok)return lt(await c.json());throw await ut("Generate Auth Token",c)}async function Rt(e,t=!1){let n;const r=await Ct(e.appConfig,(r=>{if(!Lt(r))throw ot.create("not-registered");const i=r.authToken;if(!t&&(2===(s=i).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(s)))return r;var s;if(1===i.requestStatus)return n=async function(e,t){let n=await Dt(e.appConfig);for(;1===n.authToken.requestStatus;)await ft(100),n=await Dt(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Rt(e,t):r}(e,t),r;{if(!navigator.onLine)throw ot.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await Ot(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await St(e.appConfig,r),n}catch(n){if(!at(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await St(e.appConfig,n)}else await Tt(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function Dt(e){return Ct(e,(e=>{if(!Lt(e))throw ot.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function Lt(e){return void 0!==e&&2===e.registrationStatus}function xt(e){return ot.create("missing-app-config-values",{valueName:e})}const Mt="installations";je(new A(Mt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw xt("App Configuration");if(!e.name)throw xt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw xt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Fe(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),je(new A("installations-internal",(e=>{const t=Fe(e.getProvider("app").getImmediate(),Mt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await kt(t);return r?r.catch(console.error):Rt(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await kt(e);t&&await t}(n),(await Rt(n,t)).token}(t,e)}}),"PRIVATE")),Ge(nt,rt),Ge(nt,rt,"esm2017");const Ut="analytics",jt="https://www.googletagmanager.com/gtag/js",Ft=new j("@firebase/analytics"),$t=new v("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Bt(e){if(!e.startsWith(jt)){const t=$t.create("invalid-gtag-resource",{gtagURL:e});return Ft.warn(t.message),""}return e}function Vt(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const Ht=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function zt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Wt(e,t=Ht,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw $t.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw $t.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Kt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Gt({appId:r,apiKey:i,measurementId:s},o,a,t)}async function Gt(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=Ht){var s;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r($t.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(a)return Ft.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:zt(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw $t.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof m&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(i.deleteThrottleMetadata(o),a)return Ft.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const l=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?C(n,i.intervalMillis,30):C(n,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return i.setThrottleMetadata(o,u),Ft.debug(`Calling attemptFetch again in ${l} millis`),Gt(e,u,r,i)}}class Kt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let qt,Jt;async function Yt(e,t,n,r,i,s,o){var a;const c=Wt(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Ft.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Ft.error(e))),t.push(c);const l=async function(){if(!p())return Ft.warn($t.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await g()}catch(e){return Ft.warn($t.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[u,d]=await Promise.all([c,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(jt)&&n.src.includes(e))return n;return null})(s)||function(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),n}(0,{createScriptURL:Bt}),r=document.createElement("script"),i=`${jt}?l=${e}&id=${t}`;r.src=n?null==n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}(s,u.measurementId),Jt&&(i("consent","default",Jt),Jt=void 0),i("js",new Date);const h=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return h.origin="firebase",h.update=!0,null!=d&&(h.firebase_id=d),i("config",u.measurementId,h),qt&&(i("set",qt),qt=void 0),u.measurementId}class Xt{constructor(e){this.app=e}_delete(){return delete Qt[this.app.options.appId],Promise.resolve()}}let Qt={},Zt=[];const en={};let tn,nn,rn="dataLayer",sn=!1;function on(e,t,n){!function(){const e=[];if(f()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=$t.create("invalid-analytics-context",{errorInfo:t});Ft.warn(n.message)}}();const r=e.options.appId;if(!r)throw $t.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw $t.create("no-api-key");Ft.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Qt[r])throw $t.create("already-exists",{id:r});if(!sn){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(rn);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function(e,t,n,r){return async function(i,...s){try{if("event"===i){const[r,i]=s;await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await Vt(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){Ft.error(e)}}(e,t,n,r,i)}else if("config"===i){const[i,o]=s;await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await Vt(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){Ft.error(e)}e("config",i,s)}(e,t,n,r,i,o)}else if("consent"===i){const[t,n]=s;e("consent",t,n)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(e){Ft.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(Qt,Zt,en,rn,"gtag");nn=e,tn=t,sn=!0}return Qt[r]=Yt(e,Zt,en,t,tn,rn,n),new Xt(e)}const an="@firebase/analytics",cn="0.10.12";function ln(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}je(new A(Ut,((e,{options:t})=>on(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),je(new A("analytics-internal",(function(e){try{const t=e.getProvider(Ut).getImmediate();return{logEvent:(e,n,r)=>function(e,t,n,r){e=k(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(nn,Qt[e.app.options.appId],t,n,r).catch((e=>Ft.error(e)))}(t,e,n,r)}}catch(e){throw $t.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ge(an,cn),Ge(an,cn,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const un=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},dn=new v("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),hn=new j("@firebase/auth");function fn(e,...t){hn.logLevel<=D.ERROR&&hn.error(`Auth (${He}): ${e}`,...t)}function pn(e,...t){throw yn(e,...t)}function gn(e,...t){return yn(e,...t)}function mn(e,t,n){const r=Object.assign(Object.assign({},un()),{[t]:n});return new v("auth","Firebase",r).create(t,{appName:e.name})}function vn(e){return mn(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yn(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return dn.create(e,...t)}function wn(e,t,...n){if(!e)throw yn(t,...n)}function In(e){const t="INTERNAL ASSERTION FAILED: "+e;throw fn(t),new Error(t)}function bn(e,t){e||In(t)}function _n(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function En(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Sn{constructor(e,t){this.shortDelay=e,this.longDelay=t,bn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===En()||"https:"===En()||f()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Tn(e,t){bn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Cn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void In("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void In("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void In("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const kn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},An=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Pn=new Sn(3e4,6e4);function Nn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function On(e,t,n,r,i={}){return Rn(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=b(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:a},i);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(c.referrerPolicy="no-referrer"),Cn.fetch()(await Ln(e,e.config.apiHost,n,o),c)}))}async function Rn(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},kn),t);try{const t=new Mn(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Un(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Un(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Un(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Un(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw mn(e,a,o);pn(e,a)}}catch(t){if(t instanceof m)throw t;pn(e,"network-request-failed",{message:String(t)})}}async function Dn(e,t,n,r,i={}){const s=await On(e,t,n,r,i);return"mfaPendingCredential"in s&&pn(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function Ln(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?Tn(e.config,i):`${e.config.apiScheme}://${i}`;return An.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())?s._getPersistence()._getFinalTarget(o).toString():o}function xn(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Mn{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(gn(this.auth,"network-request-failed"))),Pn.get())}))}}function Un(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=gn(e,t,r);return i.customData._tokenResponse=n,i}function jn(e){return void 0!==e&&void 0!==e.enterprise}class Fn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return xn(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function $n(e,t){return On(e,"GET","/v2/recaptchaConfig",Nn(e,t))}async function Bn(e,t){return On(e,"POST","/v1/accounts:lookup",t)}function Vn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Hn(e){return 1e3*Number(e)}function zn(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return fn("JWT malformed, contained fewer than 3 sections"),null;try{const e=a(n);return e?JSON.parse(e):(fn("Failed to decode base64 JWT payload"),null)}catch(e){return fn("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function Wn(e){const t=zn(e);return wn(t,"internal-error"),wn(void 0!==t.exp,"internal-error"),wn(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Gn(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof m&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Kn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class qn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vn(this.lastLoginAt),this.creationTime=Vn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Jn(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Gn(e,Bn(n,{idToken:r}));wn(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Yn(s.providerUserInfo):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,d=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new qn(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function Yn(e){return e.map((e=>{var{providerId:t}=e,n=ln(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Xn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wn(e.idToken,"internal-error"),wn(void 0!==e.idToken,"internal-error"),wn(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Wn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wn(0!==e.length,"internal-error");const t=Wn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(wn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Rn(e,{},(async()=>{const n=b({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await Ln(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Cn.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Xn;return n&&(wn("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(wn("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(wn("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xn,this.toJSON())}_performRefresh(){return In("not implemented")}}function Qn(e,t){wn("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Zn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=ln(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Kn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new qn(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Gn(this,this.stsTokenManager.getToken(this.auth,e));return wn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=k(e),r=await n.getIdToken(t),i=zn(r);wn(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Vn(Hn(i.auth_time)),issuedAtTime:Vn(Hn(i.iat)),expirationTime:Vn(Hn(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=k(e);await Jn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(wn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Zn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){wn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Jn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($e(this.auth.app))return Promise.reject(vn(this.auth));const e=await this.getIdToken();return await Gn(this,async function(e,t){return On(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:w,isAnonymous:I,providerData:b,stsTokenManager:_}=t;wn(y&&_,e,"internal-error");const E=Xn.fromJSON(this.name,_);wn("string"==typeof y,e,"internal-error"),Qn(u,e.name),Qn(d,e.name),wn("boolean"==typeof w,e,"internal-error"),wn("boolean"==typeof I,e,"internal-error"),Qn(h,e.name),Qn(f,e.name),Qn(p,e.name),Qn(g,e.name),Qn(m,e.name),Qn(v,e.name);const S=new Zn({uid:y,auth:e,email:d,emailVerified:w,displayName:u,isAnonymous:I,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:E,createdAt:m,lastLoginAt:v});return b&&Array.isArray(b)&&(S.providerData=b.map((e=>Object.assign({},e)))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,t,n=!1){const r=new Xn;r.updateFromServerResponse(t);const i=new Zn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Jn(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];wn(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Yn(r.providerUserInfo):[],s=!(r.email&&r.passwordHash||(null==i?void 0:i.length)),o=new Xn;o.updateFromIdToken(n);const a=new Zn({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new qn(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==i?void 0:i.length))};return Object.assign(a,c),a}}const er=new Map;function tr(e){bn(e instanceof Function,"Expected a class definition");let t=er.get(e);return t?(bn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,er.set(e,t),t)}class nr{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}nr.type="NONE";const rr=nr;function ir(e,t,n){return`firebase:${e}:${t}:${n}`}class sr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ir(this.userKey,r.apiKey,i),this.fullPersistenceKey=ir("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await Bn(this.auth,{idToken:e}).catch((()=>{}));return t?Zn._fromGetAccountInfoResponse(this.auth,t,e):null}return Zn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new sr(tr(rr),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||tr(rr);const s=ir(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){let r;if("string"==typeof t){const n=await Bn(e,{idToken:t}).catch((()=>{}));if(!n)break;r=await Zn._fromGetAccountInfoResponse(e,n,t)}else r=Zn._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new sr(i,e,n)):new sr(i,e,n)}}function or(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ur(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ar(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(hr(t))return"Blackberry";if(fr(t))return"Webos";if(cr(t))return"Safari";if((t.includes("chrome/")||lr(t))&&!t.includes("edge/"))return"Chrome";if(dr(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ar(e=h()){return/firefox\//i.test(e)}function cr(e=h()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function lr(e=h()){return/crios\//i.test(e)}function ur(e=h()){return/iemobile/i.test(e)}function dr(e=h()){return/android/i.test(e)}function hr(e=h()){return/blackberry/i.test(e)}function fr(e=h()){return/webos/i.test(e)}function pr(e=h()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function gr(e=h()){return pr(e)||dr(e)||fr(e)||hr(e)||/windows phone/i.test(e)||ur(e)}function mr(e,t=[]){let n;switch(e){case"Browser":n=or(h());break;case"Worker":n=`${or(h())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${He}/${r}`}class vr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class yr{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class wr{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new br(this),this.idTokenSubscription=new br(this),this.beforeStateQueue=new vr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=tr(t)),this._initializationPromise=this.queue((async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await sr.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Bn(this,{idToken:e}),n=await Zn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if($e(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return wn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Jn(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($e(this.app))return Promise.reject(vn(this));const t=e?k(e):null;return t&&wn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&wn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return $e(this.app)?Promise.reject(vn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $e(this.app)?Promise.reject(vn(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(tr(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return On(e,"GET","/v2/passwordPolicy",Nn(e,t))}(this),t=new yr(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new v("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return On(e,"POST","/v2/accounts:revokeToken",Nn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&tr(e)||this._popupRedirectResolver;wn(t,this,"argument-error"),this.redirectPersistenceManager=await sr.create(this,[tr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(wn(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if($e(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){hn.logLevel<=D.WARN&&hn.warn(`Auth (${He}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Ir(e){return k(e)}class br{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e){const t=new S(e,void 0);return t.subscribe.bind(t)}((e=>this.observer=e))}get next(){return wn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let _r={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Er(e){return _r.loadJS(e)}function Sr(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Tr{constructor(){this.enterprise=new Cr}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Cr{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const kr="NO_RECAPTCHA";class Ar{constructor(e){this.type="recaptcha-enterprise",this.auth=Ir(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;jn(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(kr)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new Tr).execute("siteKey",{action:"verify"}):new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{$n(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Fn(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&jn(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=_r.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Er(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Pr(e,t,n,r=!1,i=!1){const s=new Ar(e);let o;if(i)o=kr;else try{o=await s.verify(n)}catch(e){o=await s.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Nr(e,t,n,r,i){var s,o;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Pr(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Pr(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}if("PHONE_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("PHONE_PROVIDER")){const i=await Pr(e,t,n);return r(e,i).catch((async i=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await Pr(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)}))}{const i=await Pr(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}function Or(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Rr(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Dr{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return In("not implemented")}_getIdTokenResponse(e){return In("not implemented")}_linkToIdToken(e,t){return In("not implemented")}_getReauthenticationResolver(e){return In("not implemented")}}async function Lr(e,t){return On(e,"POST","/v1/accounts:signUp",t)}async function xr(e,t){return Dn(e,"POST","/v1/accounts:signInWithPassword",Nn(e,t))}class Mr extends Dr{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Mr(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Mr(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Nr(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",xr,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Dn(e,"POST","/v1/accounts:signInWithEmailLink",Nn(e,t))}(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Nr(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Lr,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Dn(e,"POST","/v1/accounts:signInWithEmailLink",Nn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ur(e,t){return Dn(e,"POST","/v1/accounts:signInWithIdp",Nn(e,t))}class jr extends Dr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new jr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=ln(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new jr(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ur(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ur(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ur(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=b(t)}return e}}async function Fr(e,t){return On(e,"POST","/v1/accounts:sendVerificationCode",Nn(e,t))}const $r={USER_NOT_FOUND:"user-not-found"};class Br extends Dr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Br({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Br({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Dn(e,"POST","/v1/accounts:signInWithPhoneNumber",Nn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Dn(e,"POST","/v1/accounts:signInWithPhoneNumber",Nn(e,t));if(n.temporaryProof)throw Un(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Dn(e,"POST","/v1/accounts:signInWithPhoneNumber",Nn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),$r)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Br({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Vr{constructor(e){var t,n,r,i,s,o;const a=_(E(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);wn(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=_(E(e)).link,n=t?_(E(t)).deep_link_id:null,r=_(E(e)).deep_link_id;return(r?_(E(r)).link:null)||r||n||t||e}(e);try{return new Vr(t)}catch(e){return null}}}class Hr{constructor(){this.providerId=Hr.PROVIDER_ID}static credential(e,t){return Mr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Vr.parseLink(t);return wn(n,"argument-error"),Mr._fromEmailAndCode(e,n.code,n.tenantId)}}Hr.PROVIDER_ID="password",Hr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Hr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class zr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Wr extends zr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Gr extends Wr{constructor(){super("facebook.com")}static credential(e){return jr._fromParams({providerId:Gr.PROVIDER_ID,signInMethod:Gr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gr.credentialFromTaggedObject(e)}static credentialFromError(e){return Gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Gr.credential(e.oauthAccessToken)}catch(e){return null}}}Gr.FACEBOOK_SIGN_IN_METHOD="facebook.com",Gr.PROVIDER_ID="facebook.com";class Kr extends Wr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return jr._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Kr.credential(t,n)}catch(e){return null}}}Kr.GOOGLE_SIGN_IN_METHOD="google.com",Kr.PROVIDER_ID="google.com";class qr extends Wr{constructor(){super("github.com")}static credential(e){return jr._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return qr.credential(e.oauthAccessToken)}catch(e){return null}}}qr.GITHUB_SIGN_IN_METHOD="github.com",qr.PROVIDER_ID="github.com";class Jr extends Wr{constructor(){super("twitter.com")}static credential(e,t){return jr._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Jr.credential(t,n)}catch(e){return null}}}Jr.TWITTER_SIGN_IN_METHOD="twitter.com",Jr.PROVIDER_ID="twitter.com";class Yr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Zn._fromIdTokenResponse(e,n,r),s=Xr(n);return new Yr({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Xr(n);return new Yr({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Xr(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Qr extends m{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Qr.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Qr(e,t,n,r)}}function Zr(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Qr._fromErrorAndOperation(e,n,t,r);throw n}))}function ei(e,t){return On(e,"POST","/v2/accounts/mfaEnrollment:start",Nn(e,t))}new WeakMap;const ti="__sak";class ni{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ti,"1"),this.storage.removeItem(ti),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class ri extends ni{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gr(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=h();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ri.type="LOCAL";const ii=ri;class si extends ni{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}si.type="SESSION";const oi=si;class ai{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ai(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ci(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ai.receivers=[];class li{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=ci("",20);r.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function ui(){return window}function di(){return void 0!==ui().WorkerGlobalScope&&"function"==typeof ui().importScripts}const hi="firebaseLocalStorageDb",fi="firebaseLocalStorage",pi="fbase_key";class gi{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function mi(e,t){return e.transaction([fi],t?"readwrite":"readonly").objectStore(fi)}function vi(){const e=indexedDB.open(hi,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(fi,{keyPath:pi})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(fi)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(hi);return new gi(e).toPromise()}(),t(await vi()))}))}))}async function yi(e,t,n){const r=mi(e,!0).put({[pi]:t,value:n});return new gi(r).toPromise()}function wi(e,t){const n=mi(e,!0).delete(t);return new gi(n).toPromise()}class Ii{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await vi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return di()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ai._getInstance(di()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new li(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vi();return await yi(e,ti,"1"),await wi(e,ti),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>yi(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=mi(e,!1).get(t),r=await new gi(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>wi(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=mi(e,!1).getAll();return new gi(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ii.type="LOCAL";const bi=Ii;function _i(e,t){return On(e,"POST","/v2/accounts/mfaSignIn:start",Nn(e,t))}Sr("rcb"),new Sn(3e4,6e4);const Ei="recaptcha";async function Si(e,t,n){var r;if(!e._getRecaptchaConfig())try{await async function(e){const t=Ir(e),n=await $n(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Fn(n);null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new Ar(t).verify()}(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"==typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){wn("enroll"===t.type,e,"internal-error");const r=Nr(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},"mfaSmsEnrollment",(async(e,t)=>t.phoneEnrollmentInfo.captchaResponse===kr?(wn((null==n?void 0:n.type)===Ei,e,"argument-error"),ei(e,await Ti(e,t,n))):ei(e,t)),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{wn("signin"===t.type,e,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;wn(s,e,"missing-multi-factor-info");const o=Nr(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},"mfaSmsSignIn",(async(e,t)=>t.phoneSignInInfo.captchaResponse===kr?(wn((null==n?void 0:n.type)===Ei,e,"argument-error"),_i(e,await Ti(e,t,n))):_i(e,t)),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t=Nr(e,{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},"sendVerificationCode",(async(e,t)=>t.captchaResponse===kr?(wn((null==n?void 0:n.type)===Ei,e,"argument-error"),Fr(e,await Ti(e,t,n))):Fr(e,t)),"PHONE_PROVIDER");return(await t.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null==n||n._reset()}}async function Ti(e,t,n){wn(n.type===Ei,e,"argument-error");const r=await n.verify();wn("string"==typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Ci{constructor(e){this.providerId=Ci.PROVIDER_ID,this.auth=Ir(e)}verifyPhoneNumber(e,t){return Si(this.auth,e,k(t))}static credential(e,t){return Br._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ci.credentialFromTaggedObject(t)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Br._fromTokenResponse(t,n):null}}function ki(e,t){return t?tr(t):(wn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Ci.PROVIDER_ID="phone",Ci.PHONE_SIGN_IN_METHOD="phone";class Ai extends Dr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ur(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ur(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ur(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Pi(e){return async function(e,t,n=!1){if($e(e.app))return Promise.reject(vn(e));const r="signIn",i=await Zr(e,r,t),s=await Yr._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Ai(e),e.bypassAuthState)}function Ni(e){const{auth:t,user:n}=e;return wn(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e;if($e(r.app))return Promise.reject(vn(r));const i="reauthenticate";try{const s=await Gn(e,Zr(r,i,t,e),n);wn(s.idToken,r,"internal-error");const o=zn(s.idToken);wn(o,r,"internal-error");const{sub:a}=o;return wn(e.uid===a,r,"user-mismatch"),Yr._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&pn(r,"user-mismatch"),e}}(n,new Ai(e),e.bypassAuthState)}async function Oi(e){const{auth:t,user:n}=e;return wn(n,t,"internal-error"),async function(e,t,n=!1){const r=await Gn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Yr._forOperation(e,"link",r)}(n,new Ai(e),e.bypassAuthState)}class Ri{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Pi;case"linkViaPopup":case"linkViaRedirect":return Oi;case"reauthViaPopup":case"reauthViaRedirect":return Ni;default:pn(this.auth,"internal-error")}}resolve(e){bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Di=new Sn(2e3,1e4);async function Li(e,t,n){if($e(e.app))return Promise.reject(gn(e,"operation-not-supported-in-this-environment"));const r=Ir(e);!function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&pn(e,"argument-error"),mn(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,zr);const i=ki(r,n);return new xi(r,"signInViaPopup",t,i).executeNotNull()}class xi extends Ri{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,xi.currentPopupAction&&xi.currentPopupAction.cancel(),xi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wn(e,this.auth,"internal-error"),e}async onExecution(){bn(1===this.filter.length,"Popup operations only handle one event");const e=ci();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(gn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(gn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Di.get())};e()}}xi.currentPopupAction=null;const Mi=new Map;class Ui extends Ri{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Mi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return ir("pendingRedirect",e.config.apiKey,e.name)}(t),r=function(e){return tr(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Mi.set(this.auth._key(),e)}return this.bypassAuthState||Mi.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ji(e,t){Mi.set(e._key(),t)}async function Fi(e,t,n=!1){if($e(e.app))return Promise.reject(vn(e));const r=Ir(e),i=ki(r,t),s=new Ui(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class $i{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Vi(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Vi(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(gn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bi(e))}saveEventToCache(e){this.cachedEventUids.add(Bi(e)),this.lastProcessedEventTime=Date.now()}}function Bi(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Vi({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Hi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zi=/^https?/;function Wi(e){const t=_n(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!zi.test(n))return!1;if(Hi.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Gi=new Sn(3e4,6e4);function Ki(){const e=ui().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function qi(e){return new Promise(((t,n)=>{var r,i,s;function o(){Ki(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ki(),n(gn(e,"network-request-failed"))},timeout:Gi.get()})}if(null===(i=null===(r=ui().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=ui().gapi)||void 0===s?void 0:s.load)){const t=Sr("iframefcb");return ui()[t]=()=>{gapi.load?o():n(gn(e,"network-request-failed"))},Er(`${_r.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Ji=null,e}))}let Ji=null;const Yi=new Sn(5e3,15e3),Xi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Qi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Zi(e){const t=e.config;wn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Tn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:He},i=Qi.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${b(r).slice(1)}`}const es={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ts{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const ns=encodeURIComponent("fac");async function rs(e,t,n,r,i,s){wn(e.config.authDomain,e,"auth-domain-config-required"),wn(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:He,eventId:i};if(t instanceof zr){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Wr){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),l=c?`#${ns}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?Tn(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${b(a).slice(1)}${l}`}const is="webStorageSupport",ss=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=oi,this._completeRedirectFn=Fi,this._overrideRedirectResult=ji}async _openPopup(e,t,n,r){var i;return bn(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},es),{width:r.toString(),height:i.toString(),top:s,left:o}),l=h().toLowerCase();n&&(a=lr(l)?"_blank":n),ar(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=h()){var t;return pr(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new ts(null);const d=window.open(t||"",a,u);wn(d,e,"popup-blocked");try{d.focus()}catch(e){}return new ts(d)}(e,await rs(e,t,n,_n(),r),ci())}async _openRedirect(e,t,n,r){return await this._originValidation(e),i=await rs(e,t,n,_n(),r),ui().location.href=i,new Promise((()=>{}));var i}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(bn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return Ji=Ji||qi(e),Ji}(e),n=ui().gapi;return wn(n,e,"internal-error"),t.open({where:document.body,url:Zi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xi,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=gn(e,"network-request-failed"),s=ui().setTimeout((()=>{r(i)}),Yi.get());function o(){ui().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new $i(e);return t.register("authEvent",(t=>(wn(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(is,{type:is},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[is];void 0!==i&&t(!!i),pn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return On(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Wi(e))return}catch(e){}pn(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return gr()||cr()||pr()}};var os="@firebase/auth",as="1.10.1";class cs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ls=u("authIdTokenMaxAge")||300;let us=null;function ds(e=We()){const t=Fe(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Fe(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(w(n.getOptions(),null!=t?t:{}))return e;pn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ss,persistence:[bi,ii,oi]}),r=u("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ls)return;const r=null==t?void 0:t.token;us!==r&&(us=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){k(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e){k(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}}var i;const s=(o="auth",null===(l=null===(a=c())||void 0===a?void 0:a.emulatorHosts)||void 0===l?void 0:l[o]);var o,a,l;return s&&function(e,t,n){const r=Ir(e);wn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Or(t),{host:o,port:a}=function(e){const t=Or(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Rr(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Rr(t)}}}(t),c={url:`${s}//${o}${null===a?"":`:${a}`}/`},l=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return wn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void wn(w(c,r.config.emulator)&&w(l,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}var hs;_r={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=gn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},hs="Browser",je(new A("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;wn(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:hs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mr(hs)},c=new wr(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(tr);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),je(new A("auth-internal",(e=>{return t=Ir(e.getProvider("auth").getImmediate()),new cs(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),Ge(os,as,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(hs)),Ge(os,as,"esm2017");const fs="https://helloworld-331777483172.us-west1.run.app/processes",ps={apiKey:"AIzaSyAr5BXnNexqOGuVoXikWZS4hSUKFh8cmDA",authDomain:"interview-proctor.firebaseapp.com",databaseURL:"https://interview-proctor-default-rtdb.firebaseio.com",projectId:"interview-proctor",storageBucket:"interview-proctor.firebasestorage.app",messagingSenderId:"124879970402",appId:"1:124879970402:web:80ce4ae7b862d6be7db13b",measurementId:"G-1SCPSVG9F2"};document.addEventListener("DOMContentLoaded",(()=>{console.log("DOM Loaded. Initializing Addon with Role Selection and Timeline.");const e=document.getElementById("status"),t=document.getElementById("error-message"),r=document.body,i=document.getElementById("role-selection"),s=document.getElementById("host-button"),o=document.getElementById("login-section"),a=document.getElementById("login-google"),c=document.getElementById("login-facebook"),l=(document.getElementById("login-microsoft"),document.getElementById("login-error-message")),u=document.getElementById("guest-button"),d=document.getElementById("guest-connection-status"),h=document.getElementById("extension-link"),f=document.getElementById("daemon-link"),p=document.getElementById("host-guest-name"),g=document.getElementById("host-overall-status-icon"),m=document.getElementById("host-last-update"),v=document.getElementById("host-processes-section"),y=document.getElementById("host-processes-status"),I=document.getElementById("host-processes-list"),b=document.getElementById("host-tabs-section"),_=document.getElementById("host-tabs-status"),E=document.getElementById("host-tabs-list"),S=document.getElementById("host-screenshot-section"),T=document.getElementById("host-screenshot-status"),C=document.getElementById("host-screenshot-details"),A=document.getElementById("host-timeline-section"),P=document.getElementById("host-timeline-list");let N=!1,O=!1,R=null,D=null,L=null,x=null,M=null;const U=ze(ps),j=(function(e=We()){const t=Fe(e=k(e),Ut);t.isInitialized()?t.getImmediate():function(e,t={}){const n=Fe(e,Ut);if(n.isInitialized()){const e=n.getImmediate();if(w(t,n.getOptions()))return e;throw $t.create("already-initialized")}n.initialize({options:t})}(e)}(U),ds(U)),F=new Kr,$=new Gr;async function B(){null==R&&(R=await n.addon.createAddonSession({cloudProjectNumber:"331777483172"})),null==D&&(D=await R.createSidePanelClient(),L=await D.getMeetingInfo(),console.log("Meeting ID:",L.meetingId),console.log("Meeting Code:",L.meetingCode))}function V(t){e.textContent=`Status: ${t}`}function H(e){e?(t.textContent=e,t.style.display="block"):(t.textContent="",t.style.display="none")}function z(e){const t=document.createElement("li");return t.textContent=e,t}function W(){if(!N||!O)return;if(!x)return p.textContent="Guest: ---",g.textContent="",g.className="status-icon unknown",m.textContent="Last Update: Waiting for guest...",y.textContent="---",y.className="status-text unknown",I.innerHTML="",_.textContent="---",_.className="status-text unknown",E.innerHTML="",T.textContent="---",T.className="status-text unknown",C.textContent="",P.innerHTML="<li><i>Waiting for guest data...</i></li>",v.style.display="none",b.style.display="none",S.style.display="none",void(A.style.display="none");p.textContent=`Guest: ${x.userName||"Unknown"}`,m.textContent=`Last Update: ${x.collectionTime?new Date(x.collectionTime).toLocaleString():"N/A"}`;let e="ok",t="",n="ok";x.error?(e="alert",H(`Guest Daemon Error: ${x.error}`)):x.status&&"ok"!==x.status&&"success"!==x.status?(e="warning",H(null)):H(null);const r=x.flaggedProcesses||[];I.innerHTML="",r.length>0?(y.textContent="FLAGGED",y.className="status-text warning",r.forEach((e=>{const t=`${e.processName} (PID: ${e.pid||"N/A"})${e.title?` - ${e.title}`:""}`;I.appendChild(z(t))})),v.style.display="block","ok"===e&&(e="warning")):(y.textContent="OK",y.className="status-text ok",I.innerHTML="<li><i>No flagged processes.</i></li>",v.style.display="block");const i=x.flaggedTabs||[];E.innerHTML="",i.length>0?(_.textContent="FLAGGED",_.className="status-text warning",i.forEach((e=>{const t=`${e.title||"Untitled Tab"} - ${e.url||"N/A"}`;E.appendChild(z(t))})),b.style.display="block","ok"===e&&(e="warning")):(_.textContent="OK",_.className="status-text ok",E.innerHTML="<li><i>No restricted tabs detected.</i></li>",b.style.display="block");const s=x.screenshot||[];C.textContent="",s.length>0?(T.textContent="CAPTURED",T.className="status-text ok",s.forEach((e=>{const t=`Display ${e.displayId||"N/A"}: ${e.imageSize||e.originalSize||"Size unknown"} (${e.format||"format unknown"})`,n=document.createElement("p");n.textContent=t,C.appendChild(n)})),S.style.display="block"):(T.textContent="N/A",T.className="status-text unknown",C.textContent="No screenshots received in this update.",S.style.display="block"),P.innerHTML="";const o=x.collectionTime?new Date(x.collectionTime).toLocaleTimeString():"No timestamp";let a=`Update received. Status: ${x.status||"N/A"}.`;if(x.error)a+=` Error: ${x.error}`;else{const e=[];r.length>0&&e.push(`${r.length} flagged process(es)`),i.length>0&&e.push(`${i.length} flagged tab(s)`),e.length>0?a+=` Issues: ${e.join(", ")}.`:a+=" No issues detected."}const c=document.createElement("li"),l=document.createElement("span"),u=document.createElement("span");l.className="timestamp",l.textContent=`[${o}]`,u.className="description",u.textContent=a,c.appendChild(l),c.appendChild(u),P.appendChild(c),A.style.display="block","alert"===e?(t="",n="alert"):"warning"===e?(t="",n="warning"):(t="",n="ok"),g.textContent=t,g.className=`status-icon ${n}`}async function G(){if(!N||!O||!L?.meetingId)return void console.warn("Host fetch skipped: Conditions not met (isHost, roleSelected, meetingId).");const e=L.meetingId;console.log(`Host fetching data for meetingId: ${e}...`),V("Host mode fetching data...");const t=new URL(fs);t.searchParams.append("meetingId",e);try{const n=await fetch(t.toString(),{method:"GET",mode:"cors",cache:"no-cache"});if(!n.ok)throw new Error(`HTTP error ${n.status}`);const r=await n.json();if(console.log(`Host received data for meeting ${e}:`,r),"object"!=typeof r||null===r)throw console.error("Received unexpected data format from server:",r),new Error("Invalid data format received from server");{const t=Object.keys(r);if(t.length>0){const e=t[0];x=r[e],console.log(`Displaying data for first candidate found: ${e}`),W(),V(`Host mode listening. Displaying data for ${x.userName||e}. Last fetch: ${(new Date).toLocaleTimeString()}`)}else console.log(`No guest data found for meeting ${e} yet.`),x=null,W(),V(`Host mode listening. Waiting for guest data in meeting ${e}...`)}}catch(t){console.error(`Error fetching data for meeting ${e}:`,t),H(`Network error fetching data: ${t.message}`),V("Network Error (GET)")}}async function K(e){if(O)console.warn("Role already selected; no need to run this again.");else{O=!0,N=e,console.log("Role selected: "+(N?"Host":"Guest")),H(null),i.style.display="none",r.classList.add("role-selected"),N?(r.classList.add("host-mode"),r.classList.remove("guest-mode")):(r.classList.add("guest-mode"),r.classList.remove("host-mode")),L?console.log("meetingId: ",L.meetingId," meetingCode: ",L.meetingCode):console.log("meetingInfo is still null"),V("Initializing codoing session...");try{if(console.log("Make sure the sidePanelClient has initialized..."),D||(console.log("The addon session and side panel has not been initialed. doing now..."),await B()),console.log("The side panel has started/joined."),N)D.startActivity({sidePanelUrl:"https://binp.github.io/addon/src/SidePanel.html"}),V("Host mode active. Fetching initial data..."),W(),G(),M||(M=setInterval(G,15e3));else{const e="https://meet.google.com";console.log("Guest sending 'addonOpened' message to target:",e),window.top.postMessage({type:"addonOpened"},e),d.textContent="Status: Waiting for connection from extension...",V("Guest mode active."),h.href="https://binp.github.io",f.href="https://binp.github.io"}}catch(e){console.error("Error starting collaboration:",e),H(`Collaboration failed: ${e.message||e}`),V("Collaboration Error"),O=!1,r.className=""}}}function q(e){if("https://meet.google.com"!==e.origin)return;const t=e.data;if(console.log("Addon received message from parent window:",t),!N&&O&&"proctorUpdate"===t?.type){console.log("Guest received process update from extension:",t.payload),d.textContent=`Status: Connected (Last update: ${(new Date).toLocaleTimeString()})`,V(`Process info received (${t.payload?.length||0}). Sending to server...`);const e=t.payload.candidateInfo;e.userId="binp000001",e.userName="Binbin Peng",e.meetingId=L.meetingId,e.meetingCode=L.meetingCode,console.log("Send the payload to the backend server: ",e),fetch(fs,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{e.success?(console.log("Successfully POSTed data to server:",e),V("Guest info sent."),d.textContent="Guest info sent. Waiting for next update..."):(console.error("Server returned error:",e.error),d.textContent=`Status: Error sending data! ${e.error}`,V("Server Error (POST)"))})).catch((e=>{console.error("Error POSTing data to server:",e),V("Network Error (POST)"),d.textContent="Error sending process info."}))}else N||!O||"daemonError"!==t?.type&&"daemonDisconnected"!==t?.type||(console.warn("Received daemon status from extension:",t.type,t.data),V("Extension Error"),d.textContent=`Extension reported an error: ${t.type}.`)}function J(e){e?(l.textContent=e,l.style.display="block"):(l.textContent="",l.style.display="none")}!function(e){k(e).onAuthStateChanged((async e=>{e?(console.log("User is signed in:",e),J(null),r.classList.add("logged-in"),o.style.display="none",i.style.display="flex",await B(),V("Please select your role above.")):(console.log("User is signed out"),r.classList.remove("logged-in"),r.classList.remove("role-selected","host-mode","guest-mode"),o.style.display="flex",i.style.display="none",V("Please log in to continue."))}),void 0,void 0)}(j),a.addEventListener("click",(()=>{Li(j,F).then((e=>{const t=e.user;console.log("Google sign-in successful:",t)})).catch((e=>{console.error("Google sign-in error:",e),J("Google login failed. "+e.message)}))})),c.addEventListener("click",(()=>{Li(j,$).then((e=>{const t=e.user;console.log("Facebook sign-in successful:",t)})).catch((e=>{console.error("Facebook sign-in error:",e),J("Facebook login failed. "+e.message)}))})),s.addEventListener("click",(()=>K(!0))),u.addEventListener("click",(()=>K(!1))),window.addEventListener("message",q),B(),window.addEventListener("unload",(()=>{window.removeEventListener("message",q),M&&clearInterval(M)}))})),helloWorld={}})();